{"version":3,"sources":["webpack://phoenix_live_view/webpack/universalModuleDefinition","webpack://phoenix_live_view/webpack/bootstrap","webpack://phoenix_live_view/./node_modules/morphdom/dist/morphdom-esm.js","webpack://phoenix_live_view/./js/phoenix_live_view.js","webpack://phoenix_live_view/(webpack)/buildin/global.js","webpack://phoenix_live_view/./js/phoenix_live_view.js-exposed"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","range","DOCUMENT_FRAGMENT_NODE","NS_XHTML","doc","document","undefined","HAS_TEMPLATE_SUPPORT","createElement","HAS_RANGE_SUPPORT","createRange","toElement","str","trim","template","innerHTML","content","childNodes","createFragmentFromTemplate","selectNode","body","createContextualFragment","createFragmentFromRange","fragment","createFragmentFromWrap","compareNodeNames","fromEl","toEl","fromCodeStart","toCodeStart","fromNodeName","nodeName","toNodeName","charCodeAt","toUpperCase","syncBooleanAttrProp","setAttribute","removeAttribute","specialElHandlers","OPTION","parentNode","parentName","hasAttribute","selected","selectedIndex","INPUT","TEXTAREA","newValue","firstChild","oldValue","nodeValue","placeholder","SELECT","optgroup","curChild","nextSibling","ELEMENT_NODE","DOCUMENT_FRAGMENT_NODE$1","TEXT_NODE","COMMENT_NODE","noop","defaultGetNodeKey","node","getAttribute","id","morphdom_esm","morphAttrs","fromNode","toNode","options","toNodeHtml","getNodeKey","onBeforeNodeAdded","onNodeAdded","onBeforeElUpdated","onElUpdated","onBeforeNodeDiscarded","onNodeDiscarded","onBeforeElChildrenUpdated","childrenOnly","fromNodesLookup","create","keyedRemovalList","addKeyedRemoval","key","push","removeNode","skipKeyedNodes","removeChild","walkDiscardedChildNodes","nodeType","handleNodeAdded","el","unmatchedFromEl","replaceChild","morphEl","toElKey","curToNodeKey","curFromNodeKey","fromNextSibling","toNextSibling","matchingFromEl","curToNodeChild","curFromNodeChild","outer","isSameNode","curFromNodeType","isCompatible","insertBefore","appendChild","onBeforeNodeAddedResult","actualize","ownerDocument","cleanupFromEl","specialElHandler","morphChildren","indexTree","morphedNode","morphedNodeType","toNodeType","nextChild","moveChildren","namespaceURI","createElementNS","len","length","elToRemove","morphdomFactory","attr","attrName","attrNamespaceURI","attrValue","toNodeAttrs","attributes","localName","getAttributeNS","prefix","setAttributeNS","fromNodeAttrs","hasAttributeNS","removeAttributeNS","RELOAD_JITTER","PHX_VIEW","PHX_EVENT_CLASSES","PHX_COMPONENT","PHX_REF","PHX_UPLOAD_REF","PHX_VIEW_SELECTOR","concat","FOCUSABLE_INPUTS","CHECKABLE_INPUTS","LOADER_TIMEOUT","BINDING_PREFIX","DEFAULTS","debounce","throttle","logError","msg","obj","console","error","debug","view","kind","liveSocket","isDebugEnabled","log","closure","val","clone","JSON","parse","stringify","closestPhxBinding","binding","borderEl","matches","parentElement","isObject","_typeof","Array","isEmpty","x","maybe","callback","UploadEntry","fileEl","file","_classCallCheck","ref","LiveUploader","genFileRef","meta","_isCancelled","_isDone","_progress","_lastProgressSent","_onDone","isNew","_phxRef","isActive","split","indexOf","size","isPreflighted","progress","_this","Math","floor","pushFileProgress","untrackFile","reason","arguments","clearFiles","last_modified","lastModified","type","uploaders","uploader","channelUploader","resp","entries","input","response","Hooks","preflightedRefs","mounted","preflightedWas","updated","newPreflights","__view","cancelSubmit","form","LiveImgPreview","_this2","inputEl","getElementById","getEntryDataURL","url","src","liveUploaderFileRef","onComplete","_entries","from","filesAwaitingPreflight","map","numEntriesInProgress","toString","_this3","activeFiles","find","reader","FileReader","onload","e","target","result","readAsDataURL","formEl","active","DOM","findUploadInputs","forEach","_this4","fileData","entry","path","uploadRef","putPrivate","filter","f","is","files","_this5","newFiles","_this6","fileInputs","_this7","onError","_this8","zipPostFlight","onDone","groupedEntries","reduce","acc","_entry$uploader","_groupedEntries$name","EntryUploader","config","chunk_size","upload","chunkSize","offset","chunkTimer","uploadChannel","channel","token","metadata","clearTimeout","leave","_this9","join","receive","data","readNextChunk","_this10","window","blob","slice","byteLength","pushChunk","readAsArrayBuffer","chunk","_this11","isJoined","isDone","setTimeout","getLatencySim","serializeForm","formData","FormData","toRemove","index","File","_step","params","URLSearchParams","_iterator","_createForOfIteratorHelper","done","_step$value","_slicedToArray","append","err","metaKey","Rendered","viewId","rendered","mergeDiff","_createClass","diff","reply","events","title","onlyCids","recursiveToString","components","output","buffer","Set","toOutputBuffer","keys","parseInt","cid","newc","cache","mutableMerge","oldc","cachedFindComponent","cdiff","ndiff","stat","tdiff","scid","cloneMerge","source","doMutableMerge","targetVal","merged","_objectSpread","recursiveCIDToString","cids","_this12","comprehensionToBuffer","statics","dynamicToBuffer","dynamics","dynamic","_this13","component","container","skip","has","_Array$from$reduce2","_ref","child","_ref2","hasNodes","hasComponents","Node","parentViewId","replaceWith","createSpan","remove","hasChildNodes","hasChildComponents","outerHTML","text","span","innerText","LiveSocket","phxSocket","_this14","opts","unloaded","constructor","Error","socket","bindingPrefix","viewLogger","metadataCallbacks","defaults","assign","activeElement","prevActive","silenced","main","linkRef","roots","href","location","pendingLink","currentLocation","hooks","loaderTimeout","localStorage","sessionStorage","boundTopLevelEvents","domCallbacks","dom","addEventListener","onOpen","isUnloaded","reload","getItem","setItem","removeItem","upperBoundMs","enableDebug","_this15","doConnect","joinRootViews","bindTopLevelEvents","connect","readyState","disconnect","args","_this$domCallbacks","apply","_toConsumableArray","func","isProfileEnabled","time","timeEnd","msgCallback","_msgCallback2","_msgCallback4","event","cb","_this16","on","latency","_this17","oldJoinCount","joinCount","timeout","reloadWithJitter","fakePush","receives","_ref3","_ref4","_this18","destroy","minMs","maxMs","afterMs","random","tries","Browser","updateLocal","count","hasPendingLink","startsWith","isConnected","getBindingPrefix","topic","_this19","rootsFound","all","rootEl","getRootById","joinRootView","getHref","to","flash","redirect","_this20","setPendingLink","mainEl","showLoader","fetchPage","status","html","isPhxView","newMain","commitPendingLink","View","childEl","_this21","closest","getViewByEl","_this22","owner","phxTarget","withinTargets","rootId","getDescendentByEl","destroyDescendent","_this23","cancel","removeEventListener","ownsElement","focus","getActiveElement","blur","_this24","persisted","getSocket","withPageLoading","bindClicks","bindNav","bindForms","bind","keyup","keydown","targetCtx","phxEvent","matchKey","pressedKey","toLowerCase","pushKey","eventMeta","targetEl","pushEvent","preventDefault","dropTargetId","trueTarget","dropTarget","dataTransfer","disabled","FileList","trackFiles","dispatchEvent","Event","bubbles","eventName","_this25","_loop","browserEventName","windowBinding","targetPhxEvent","withinOwners","bindClick","bindingName","capture","_this26","click","querySelector","_this27","canPushState","history","scrollRestoration","scrollTimer","updateCurrentState","state","scroll","scrollY","registerNewLocation","_ref5","pushLinkPatch","replaceMain","replaceRootHistory","scrollTo","wantsNewTab","ctrlKey","button","linkState","pushHistoryPatch","historyRedirect","info","_this28","historyPatch","pushState","_this29","newLocation","_this$currentLocation","pathname","search","_this30","iterations","submitForm","_loop2","_arr2","_i2","validity","badInput","currentIterations","_ref6","at","lastType","isTextualInput","setActiveElement","pushInput","phxDebounce","phxThrottle","defaultDebounce","defaultThrottle","_this31","dropLocal","namespace","subkey","localKey","initial","current","getLocal","newVal","req","XMLHttpRequest","open","setRequestHeader","onerror","ontimeout","onreadystatechange","requestURL","URL","requestPath","responseURL","getResponseHeader","responsePath","responseText","send","replaceState","currentState","hashEl","getHashTargetEl","hash","scrollIntoView","setCookie","cookie","getCookie","replace","RegExp","toURL","maybeHash","substring","byId","removeClass","className","classList","query","array","querySelectorAll","childNodeLength","childElementCount","isUploadInput","findComponentNodeList","filterWithinSameLiveView","isPhxDestroyed","markPhxChildDestroyed","findPhxChildrenInFragment","parentId","findPhxChildren","isIgnored","phxUpdate","isPhxUpdate","updateTypes","findParentCIDs","_this32","selector","childCID","nodes","parent","_this33","withinSameLiveView","private","deletePrivate","copyPrivates","putTitle","_titleEl$dataset","dataset","suffix","_this34","once","currentCycle","incCycle","isNaN","newKeyDown","prevKey","triggerCycle","_ref7","_ref8","_this$private2","cycle","trigger","_ref10","discardError","phxFeedbackFor","field","add","showError","_this35","isPhxChild","eventString","detail","CustomEvent","cancelable","cloneNode","cloned","mergeAttrs","exclude","sourceAttrs","targetAttrs","mergeFocusedInput","HTMLSelectElement","except","readOnly","hasSelectionRange","setSelectionRange","restoreFocus","focused","selectionStart","selectionEnd","wasFocused","isFormInput","test","tagName","syncAttrsToProps","HTMLInputElement","toLocaleLowerCase","checked","isNowTriggerFormExternal","phxTriggerExternal","syncPendingRef","disableWith","contains","cleanChildNodes","childNode","DOMPostMorphRestorer","containerBefore","containerAfter","updateType","idsBefore","idsAfter","children","elementsToModify","previousElementId","previousElementSibling","elementId","containerId","elementIdsToAdd","elementToModify","previousElem","elem","insertAdjacentElement","reverse","elemId","DOMPatch","targetCID","rootID","cidPatch","callbacks","beforeadded","beforeupdated","beforephxChildAdded","afteradded","afterupdated","afterdiscarded","afterphxChildAdded","morphdom","_len","_key","_len2","_key2","_this36","targetContainer","isCIDPatch","targetCIDContainer","_ref11","added","updates","appendPrependUpdates","externalFormTriggered","diffHTML","buildDiffHTML","trackBefore","trackAfter","destroyViewByEl","skipCIDSibling","prevSession","forceFocusedSelectUpdate","ids","elems","detectDuplicateIds","update","perform","silenceEvents","submit","isSelect","t","multiple","_DOM$findComponentNod2","_toArray","first","_this37","isCIDWithSingleRoot","diffContainer","_DOM$findComponentNod4","firstComponent","rest","parentView","_this38","childJoins","loaderTimer","pendingDiffs","pruningCIDs","joinPending","destroyed","joinCallback","stopCallback","pendingJoinOps","viewHooks","formSubmits","connectParams","session","getSession","static","getStatic","bindChannel","manifest","canPush","_this39","destroyAllChildren","onFinished","destroyHook","_this$el$classList","_this40","__disconnected","setContainerClasses","__reconnected","_this41","HTMLElement","targets","rawDiff","_Rendered$extract","extract","_this42","applyDiff","_ref12","renderContainer","dropPendingRefs","forms","formsForRecovery","pushFormRecovery","onJoinComplete","_ref13","_this43","live_patch","isJoinPending","applyJoinPatch","phxStatic","joinChild","ackJoin","onAllChildJoinsComplete","_ref14","_ref15","payload","_this44","attachTrueDocEl","patch","markPrunableContentForRemoval","performPatch","joinNewChildren","hookEl","hook","addHook","__mounted","dispatchEvents","applyPendingUpdates","hideLoader","triggerReconnected","triggerDOM","getHook","isEqualNode","obj1","obj2","isEqualObj","__beforeUpdate","pruneCids","_this45","destroyedCIDs","phxChildrenAdded","updatedHookIds","after","newHook","before","triggerBeforeUpdateHook","__updated","componentID","maybePushComponentsDestroyed","_this46","childId","getChildById","_ref16","_ref17","op","isDestroyed","_this47","isComponentOnlyDiff","componentCIDs","parentCID","componentPatch","getComponent","_this48","tag","componentToString","ViewHook","elementID","hookName","getHookCallbacks","__destroyed","__cleanup__","_this49","_ref18","_this50","onChannel","_this51","_ref19","_ref20","onRedirect","redir","onLivePatch","onLiveRedirect","trace","onClose","expandURL","protocol","host","_ref21","_this52","wrapPush","onJoin","onJoinError","live_redirect","visibilityState","dropActiveElement","displayError","isMain","refGenerator","_this53","onReply","_ref23","onLoadingDone","hookReply","undoRefs","_ref24","_this54","disableRestore","patchEl","elements","newRef","disableText","closestComponentID","_this55","_this$putRef2","putRef","els","pushWithReply","_this56","extractMeta","targetComponentID","keyElement","_this57","entryRef","entry_ref","eventTarget","_this58","_target","uploads","serializeUploads","_refGenerator2","uploadFiles","triggerAwaitingSubmit","awaitingSubmit","getScheduledSubmit","_awaitingSubmit","_ref25","_ref26","_this59","_ref27","_ref28","_this60","filterIgnored","filterDisables","filterButton","filterInput","includes","formElements","disables","buttons","inputs","hasUploadsInProgress","_refGenerator4","scheduleSubmit","pushFormSubmit","inputsAwaitingPreflight","_refGenerator6","proxyRefGen","_this61","joinCountAtUpload","activeFileInputs","toPreflightPayload","_resp$error","initAdapterUpload","_this62","_this63","refGen","link_redirect","_this64","phxChange","_this$pruningCIDs","_this65","willDestroyCIDs","completelyDestroyCIDs","pruneCIDs","_this66","blurActiveElement","restorePreviouslyActiveFocus","viewHookID","__liveSocket","__callbacks","__listeners","__isDisconnected","viewName","phxHookId","makeID","beforeUpdate","reconnected","disconnected","pushHookEvent","callbackRef","customEvent","bypass","_this67","removeHandleEvent","g","Function","eval","global"],"mappings":"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","file":"phoenix_live_view.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"phoenix_live_view\"] = factory();\n\telse\n\t\troot[\"phoenix_live_view\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","var DOCUMENT_FRAGMENT_NODE = 11;\n\nfunction morphAttrs(fromNode, toNode) {\n    var toNodeAttrs = toNode.attributes;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    // document-fragments dont have attributes so lets not do anything\n    if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE || fromNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n      return;\n    }\n\n    // update attributes on original DOM element\n    for (var i = toNodeAttrs.length - 1; i >= 0; i--) {\n        attr = toNodeAttrs[i];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n        attrValue = attr.value;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n            fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n            if (fromValue !== attrValue) {\n                if (attr.prefix === 'xmlns'){\n                    attrName = attr.name; // It's not allowed to set an attribute with the XMLNS namespace without specifying the `xmlns` prefix\n                }\n                fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n            }\n        } else {\n            fromValue = fromNode.getAttribute(attrName);\n\n            if (fromValue !== attrValue) {\n                fromNode.setAttribute(attrName, attrValue);\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    var fromNodeAttrs = fromNode.attributes;\n\n    for (var d = fromNodeAttrs.length - 1; d >= 0; d--) {\n        attr = fromNodeAttrs[d];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n\n            if (!toNode.hasAttributeNS(attrNamespaceURI, attrName)) {\n                fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n            }\n        } else {\n            if (!toNode.hasAttribute(attrName)) {\n                fromNode.removeAttribute(attrName);\n            }\n        }\n    }\n}\n\nvar range; // Create a range object for efficently rendering strings to elements.\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar doc = typeof document === 'undefined' ? undefined : document;\nvar HAS_TEMPLATE_SUPPORT = !!doc && 'content' in doc.createElement('template');\nvar HAS_RANGE_SUPPORT = !!doc && doc.createRange && 'createContextualFragment' in doc.createRange();\n\nfunction createFragmentFromTemplate(str) {\n    var template = doc.createElement('template');\n    template.innerHTML = str;\n    return template.content.childNodes[0];\n}\n\nfunction createFragmentFromRange(str) {\n    if (!range) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment = range.createContextualFragment(str);\n    return fragment.childNodes[0];\n}\n\nfunction createFragmentFromWrap(str) {\n    var fragment = doc.createElement('body');\n    fragment.innerHTML = str;\n    return fragment.childNodes[0];\n}\n\n/**\n * This is about the same\n * var html = new DOMParser().parseFromString(str, 'text/html');\n * return html.body.firstChild;\n *\n * @method toElement\n * @param {String} str\n */\nfunction toElement(str) {\n    str = str.trim();\n    if (HAS_TEMPLATE_SUPPORT) {\n      // avoid restrictions on content for things like `<tr><th>Hi</th></tr>` which\n      // createContextualFragment doesn't support\n      // <template> support not available in IE\n      return createFragmentFromTemplate(str);\n    } else if (HAS_RANGE_SUPPORT) {\n      return createFragmentFromRange(str);\n    }\n\n    return createFragmentFromWrap(str);\n}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n    var fromCodeStart, toCodeStart;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    fromCodeStart = fromNodeName.charCodeAt(0);\n    toCodeStart = toNodeName.charCodeAt(0);\n\n    // If the target element is a virtual DOM node or SVG node then we may\n    // need to normalize the tag name before comparing. Normal HTML elements that are\n    // in the \"http://www.w3.org/1999/xhtml\"\n    // are converted to upper case\n    if (fromCodeStart <= 90 && toCodeStart >= 97) { // from is upper and to is lower\n        return fromNodeName === toNodeName.toUpperCase();\n    } else if (toCodeStart <= 90 && fromCodeStart >= 97) { // to is upper and from is lower\n        return toNodeName === fromNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name);\n        }\n    }\n}\n\nvar specialElHandlers = {\n    OPTION: function(fromEl, toEl) {\n        var parentNode = fromEl.parentNode;\n        if (parentNode) {\n            var parentName = parentNode.nodeName.toUpperCase();\n            if (parentName === 'OPTGROUP') {\n                parentNode = parentNode.parentNode;\n                parentName = parentNode && parentNode.nodeName.toUpperCase();\n            }\n            if (parentName === 'SELECT' && !parentNode.hasAttribute('multiple')) {\n                if (fromEl.hasAttribute('selected') && !toEl.selected) {\n                    // Workaround for MS Edge bug where the 'selected' attribute can only be\n                    // removed if set to a non-empty value:\n                    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n                    fromEl.setAttribute('selected', 'selected');\n                    fromEl.removeAttribute('selected');\n                }\n                // We have to reset select element's selectedIndex to -1, otherwise setting\n                // fromEl.selected using the syncBooleanAttrProp below has no effect.\n                // The correct selectedIndex will be set in the SELECT special handler below.\n                parentNode.selectedIndex = -1;\n            }\n        }\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!toEl.hasAttribute('value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        var firstChild = fromEl.firstChild;\n        if (firstChild) {\n            // Needed for IE. Apparently IE sets the placeholder as the\n            // node value and vise versa. This ignores an empty update.\n            var oldValue = firstChild.nodeValue;\n\n            if (oldValue == newValue || (!newValue && oldValue == fromEl.placeholder)) {\n                return;\n            }\n\n            firstChild.nodeValue = newValue;\n        }\n    },\n    SELECT: function(fromEl, toEl) {\n        if (!toEl.hasAttribute('multiple')) {\n            var selectedIndex = -1;\n            var i = 0;\n            // We have to loop through children of fromEl, not toEl since nodes can be moved\n            // from toEl to fromEl directly when morphing.\n            // At the time this special handler is invoked, all children have already been morphed\n            // and appended to / removed from fromEl, so using fromEl here is safe and correct.\n            var curChild = fromEl.firstChild;\n            var optgroup;\n            var nodeName;\n            while(curChild) {\n                nodeName = curChild.nodeName && curChild.nodeName.toUpperCase();\n                if (nodeName === 'OPTGROUP') {\n                    optgroup = curChild;\n                    curChild = optgroup.firstChild;\n                } else {\n                    if (nodeName === 'OPTION') {\n                        if (curChild.hasAttribute('selected')) {\n                            selectedIndex = i;\n                            break;\n                        }\n                        i++;\n                    }\n                    curChild = curChild.nextSibling;\n                    if (!curChild && optgroup) {\n                        curChild = optgroup.nextSibling;\n                        optgroup = null;\n                    }\n                }\n            }\n\n            fromEl.selectedIndex = selectedIndex;\n        }\n    }\n};\n\nvar ELEMENT_NODE = 1;\nvar DOCUMENT_FRAGMENT_NODE$1 = 11;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\nfunction noop() {}\n\nfunction defaultGetNodeKey(node) {\n  if (node) {\n      return (node.getAttribute && node.getAttribute('id')) || node.id;\n  }\n}\n\nfunction morphdomFactory(morphAttrs) {\n\n    return function morphdom(fromNode, toNode, options) {\n        if (!options) {\n            options = {};\n        }\n\n        if (typeof toNode === 'string') {\n            if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML' || fromNode.nodeName === 'BODY') {\n                var toNodeHtml = toNode;\n                toNode = doc.createElement('html');\n                toNode.innerHTML = toNodeHtml;\n            } else {\n                toNode = toElement(toNode);\n            }\n        }\n\n        var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n        var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n        var onNodeAdded = options.onNodeAdded || noop;\n        var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n        var onElUpdated = options.onElUpdated || noop;\n        var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n        var onNodeDiscarded = options.onNodeDiscarded || noop;\n        var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n        var childrenOnly = options.childrenOnly === true;\n\n        // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n        var fromNodesLookup = Object.create(null);\n        var keyedRemovalList = [];\n\n        function addKeyedRemoval(key) {\n            keyedRemovalList.push(key);\n        }\n\n        function walkDiscardedChildNodes(node, skipKeyedNodes) {\n            if (node.nodeType === ELEMENT_NODE) {\n                var curChild = node.firstChild;\n                while (curChild) {\n\n                    var key = undefined;\n\n                    if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n                        // If we are skipping keyed nodes then we add the key\n                        // to a list so that it can be handled at the very end.\n                        addKeyedRemoval(key);\n                    } else {\n                        // Only report the node as discarded if it is not keyed. We do this because\n                        // at the end we loop through all keyed elements that were unmatched\n                        // and then discard them in one final pass.\n                        onNodeDiscarded(curChild);\n                        if (curChild.firstChild) {\n                            walkDiscardedChildNodes(curChild, skipKeyedNodes);\n                        }\n                    }\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        /**\n         * Removes a DOM node out of the original DOM\n         *\n         * @param  {Node} node The node to remove\n         * @param  {Node} parentNode The nodes parent\n         * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n         * @return {undefined}\n         */\n        function removeNode(node, parentNode, skipKeyedNodes) {\n            if (onBeforeNodeDiscarded(node) === false) {\n                return;\n            }\n\n            if (parentNode) {\n                parentNode.removeChild(node);\n            }\n\n            onNodeDiscarded(node);\n            walkDiscardedChildNodes(node, skipKeyedNodes);\n        }\n\n        // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n        // function indexTree(root) {\n        //     var treeWalker = document.createTreeWalker(\n        //         root,\n        //         NodeFilter.SHOW_ELEMENT);\n        //\n        //     var el;\n        //     while((el = treeWalker.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n        //\n        // function indexTree(node) {\n        //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n        //     var el;\n        //     while((el = nodeIterator.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        function indexTree(node) {\n            if (node.nodeType === ELEMENT_NODE || node.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n                var curChild = node.firstChild;\n                while (curChild) {\n                    var key = getNodeKey(curChild);\n                    if (key) {\n                        fromNodesLookup[key] = curChild;\n                    }\n\n                    // Walk recursively\n                    indexTree(curChild);\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        indexTree(fromNode);\n\n        function handleNodeAdded(el) {\n            onNodeAdded(el);\n\n            var curChild = el.firstChild;\n            while (curChild) {\n                var nextSibling = curChild.nextSibling;\n\n                var key = getNodeKey(curChild);\n                if (key) {\n                    var unmatchedFromEl = fromNodesLookup[key];\n                    // if we find a duplicate #id node in cache, replace `el` with cache value\n                    // and morph it to the child node.\n                    if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n                        curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n                        morphEl(unmatchedFromEl, curChild);\n                    } else {\n                      handleNodeAdded(curChild);\n                    }\n                } else {\n                  // recursively call for curChild and it's children to see if we find something in\n                  // fromNodesLookup\n                  handleNodeAdded(curChild);\n                }\n\n                curChild = nextSibling;\n            }\n        }\n\n        function cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey) {\n            // We have processed all of the \"to nodes\". If curFromNodeChild is\n            // non-null then we still have some from nodes left over that need\n            // to be removed\n            while (curFromNodeChild) {\n                var fromNextSibling = curFromNodeChild.nextSibling;\n                if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n                    // Since the node is keyed it might be matched up later so we defer\n                    // the actual removal to later\n                    addKeyedRemoval(curFromNodeKey);\n                } else {\n                    // NOTE: we skip nested keyed nodes from being removed since there is\n                    //       still a chance they will be matched up later\n                    removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                }\n                curFromNodeChild = fromNextSibling;\n            }\n        }\n\n        function morphEl(fromEl, toEl, childrenOnly) {\n            var toElKey = getNodeKey(toEl);\n\n            if (toElKey) {\n                // If an element with an ID is being morphed then it will be in the final\n                // DOM so clear it out of the saved elements collection\n                delete fromNodesLookup[toElKey];\n            }\n\n            if (!childrenOnly) {\n                // optional\n                if (onBeforeElUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n\n                // update attributes on original DOM element first\n                morphAttrs(fromEl, toEl);\n                // optional\n                onElUpdated(fromEl);\n\n                if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n            }\n\n            if (fromEl.nodeName !== 'TEXTAREA') {\n              morphChildren(fromEl, toEl);\n            } else {\n              specialElHandlers.TEXTAREA(fromEl, toEl);\n            }\n        }\n\n        function morphChildren(fromEl, toEl) {\n            var curToNodeChild = toEl.firstChild;\n            var curFromNodeChild = fromEl.firstChild;\n            var curToNodeKey;\n            var curFromNodeKey;\n\n            var fromNextSibling;\n            var toNextSibling;\n            var matchingFromEl;\n\n            // walk the children\n            outer: while (curToNodeChild) {\n                toNextSibling = curToNodeChild.nextSibling;\n                curToNodeKey = getNodeKey(curToNodeChild);\n\n                // walk the fromNode children all the way through\n                while (curFromNodeChild) {\n                    fromNextSibling = curFromNodeChild.nextSibling;\n\n                    if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    curFromNodeKey = getNodeKey(curFromNodeChild);\n\n                    var curFromNodeType = curFromNodeChild.nodeType;\n\n                    // this means if the curFromNodeChild doesnt have a match with the curToNodeChild\n                    var isCompatible = undefined;\n\n                    if (curFromNodeType === curToNodeChild.nodeType) {\n                        if (curFromNodeType === ELEMENT_NODE) {\n                            // Both nodes being compared are Element nodes\n\n                            if (curToNodeKey) {\n                                // The target node has a key so we want to match it up with the correct element\n                                // in the original DOM tree\n                                if (curToNodeKey !== curFromNodeKey) {\n                                    // The current element in the original DOM tree does not have a matching key so\n                                    // let's check our lookup to see if there is a matching element in the original\n                                    // DOM tree\n                                    if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                                        if (fromNextSibling === matchingFromEl) {\n                                            // Special case for single element removals. To avoid removing the original\n                                            // DOM node out of the tree (since that can break CSS transitions, etc.),\n                                            // we will instead discard the current node and wait until the next\n                                            // iteration to properly match up the keyed target element with its matching\n                                            // element in the original tree\n                                            isCompatible = false;\n                                        } else {\n                                            // We found a matching keyed element somewhere in the original DOM tree.\n                                            // Let's move the original DOM node into the current position and morph\n                                            // it.\n\n                                            // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                                            // the `removeNode()` function for the node that is being discarded so that\n                                            // all lifecycle hooks are correctly invoked\n                                            fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                                            // fromNextSibling = curFromNodeChild.nextSibling;\n\n                                            if (curFromNodeKey) {\n                                                // Since the node is keyed it might be matched up later so we defer\n                                                // the actual removal to later\n                                                addKeyedRemoval(curFromNodeKey);\n                                            } else {\n                                                // NOTE: we skip nested keyed nodes from being removed since there is\n                                                //       still a chance they will be matched up later\n                                                removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                                            }\n\n                                            curFromNodeChild = matchingFromEl;\n                                        }\n                                    } else {\n                                        // The nodes are not compatible since the \"to\" node has a key and there\n                                        // is no matching keyed node in the source tree\n                                        isCompatible = false;\n                                    }\n                                }\n                            } else if (curFromNodeKey) {\n                                // The original has a key\n                                isCompatible = false;\n                            }\n\n                            isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n                            if (isCompatible) {\n                                // We found compatible DOM elements so transform\n                                // the current \"from\" node to match the current\n                                // target DOM node.\n                                // MORPH\n                                morphEl(curFromNodeChild, curToNodeChild);\n                            }\n\n                        } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n                            // Both nodes being compared are Text or Comment nodes\n                            isCompatible = true;\n                            // Simply update nodeValue on the original node to\n                            // change the text value\n                            if (curFromNodeChild.nodeValue !== curToNodeChild.nodeValue) {\n                                curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n                            }\n\n                        }\n                    }\n\n                    if (isCompatible) {\n                        // Advance both the \"to\" child and the \"from\" child since we found a match\n                        // Nothing else to do as we already recursively called morphChildren above\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    // No compatible match so remove the old node from the DOM and continue trying to find a\n                    // match in the original DOM. However, we only do this if the from node is not keyed\n                    // since it is possible that a keyed node might match up with a node somewhere else in the\n                    // target tree and we don't want to discard it just yet since it still might find a\n                    // home in the final DOM tree. After everything is done we will remove any keyed nodes\n                    // that didn't find a home\n                    if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                    } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                    }\n\n                    curFromNodeChild = fromNextSibling;\n                } // END: while(curFromNodeChild) {}\n\n                // If we got this far then we did not find a candidate match for\n                // our \"to node\" and we exhausted all of the children \"from\"\n                // nodes. Therefore, we will just append the current \"to\" node\n                // to the end\n                if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n                    fromEl.appendChild(matchingFromEl);\n                    // MORPH\n                    morphEl(matchingFromEl, curToNodeChild);\n                } else {\n                    var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n                    if (onBeforeNodeAddedResult !== false) {\n                        if (onBeforeNodeAddedResult) {\n                            curToNodeChild = onBeforeNodeAddedResult;\n                        }\n\n                        if (curToNodeChild.actualize) {\n                            curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n                        }\n                        fromEl.appendChild(curToNodeChild);\n                        handleNodeAdded(curToNodeChild);\n                    }\n                }\n\n                curToNodeChild = toNextSibling;\n                curFromNodeChild = fromNextSibling;\n            }\n\n            cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey);\n\n            var specialElHandler = specialElHandlers[fromEl.nodeName];\n            if (specialElHandler) {\n                specialElHandler(fromEl, toEl);\n            }\n        } // END: morphChildren(...)\n\n        var morphedNode = fromNode;\n        var morphedNodeType = morphedNode.nodeType;\n        var toNodeType = toNode.nodeType;\n\n        if (!childrenOnly) {\n            // Handle the case where we are given two DOM nodes that are not\n            // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n            if (morphedNodeType === ELEMENT_NODE) {\n                if (toNodeType === ELEMENT_NODE) {\n                    if (!compareNodeNames(fromNode, toNode)) {\n                        onNodeDiscarded(fromNode);\n                        morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n                    }\n                } else {\n                    // Going from an element node to a text node\n                    morphedNode = toNode;\n                }\n            } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n                if (toNodeType === morphedNodeType) {\n                    if (morphedNode.nodeValue !== toNode.nodeValue) {\n                        morphedNode.nodeValue = toNode.nodeValue;\n                    }\n\n                    return morphedNode;\n                } else {\n                    // Text node to something else\n                    morphedNode = toNode;\n                }\n            }\n        }\n\n        if (morphedNode === toNode) {\n            // The \"to node\" was not compatible with the \"from node\" so we had to\n            // toss out the \"from node\" and use the \"to node\"\n            onNodeDiscarded(fromNode);\n        } else {\n            if (toNode.isSameNode && toNode.isSameNode(morphedNode)) {\n                return;\n            }\n\n            morphEl(morphedNode, toNode, childrenOnly);\n\n            // We now need to loop over any keyed nodes that might need to be\n            // removed. We only do the removal if we know that the keyed node\n            // never found a match. When a keyed node is matched up we remove\n            // it out of fromNodesLookup and we use fromNodesLookup to determine\n            // if a keyed node has been matched up or not\n            if (keyedRemovalList) {\n                for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n                    var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n                    if (elToRemove) {\n                        removeNode(elToRemove, elToRemove.parentNode, false);\n                    }\n                }\n            }\n        }\n\n        if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n            if (morphedNode.actualize) {\n                morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n            }\n            // If we had to swap out the from node with a new node because the old\n            // node was not compatible with the target node then we need to\n            // replace the old DOM node in the original DOM tree. This is only\n            // possible if the original DOM node was part of a DOM tree which\n            // we know is the case if it has a parent node.\n            fromNode.parentNode.replaceChild(morphedNode, fromNode);\n        }\n\n        return morphedNode;\n    };\n}\n\nvar morphdom = morphdomFactory(morphAttrs);\n\nexport default morphdom;\n","/*\n================================================================================\nPhoenix LiveView JavaScript Client\n================================================================================\n\nSee the hexdocs at `https://hexdocs.pm/phoenix_live_view` for documentation.\n\n*/\n\nimport morphdom from \"morphdom\"\n\nconst CONSECUTIVE_RELOADS = \"consecutive-reloads\"\nconst MAX_RELOADS = 10\nconst RELOAD_JITTER = [1000, 3000]\nconst FAILSAFE_JITTER = 30000\nconst PHX_VIEW = \"data-phx-view\"\nconst PHX_EVENT_CLASSES = [\n  \"phx-click-loading\", \"phx-change-loading\", \"phx-submit-loading\",\n  \"phx-keydown-loading\", \"phx-keyup-loading\", \"phx-blur-loading\", \"phx-focus-loading\"\n]\nconst PHX_COMPONENT = \"data-phx-component\"\nconst PHX_LIVE_LINK = \"data-phx-link\"\nconst PHX_TRACK_STATIC = \"track-static\"\nconst PHX_LINK_STATE = \"data-phx-link-state\"\nconst PHX_REF = \"data-phx-ref\"\nconst PHX_UPLOAD_REF = \"data-phx-upload-ref\"\nconst PHX_PREFLIGHTED_REFS = \"data-phx-preflighted-refs\"\nconst PHX_DONE_REFS = \"data-phx-done-refs\"\nconst PHX_DROP_TARGET = \"drop-target\"\nconst PHX_ACTIVE_ENTRY_REFS = \"data-phx-active-refs\"\nconst PHX_SKIP = \"data-phx-skip\"\nconst PHX_REMOVE = \"data-phx-remove\"\nconst PHX_PAGE_LOADING = \"page-loading\"\nconst PHX_CONNECTED_CLASS = \"phx-connected\"\nconst PHX_DISCONNECTED_CLASS = \"phx-disconnected\"\nconst PHX_NO_FEEDBACK_CLASS = \"phx-no-feedback\"\nconst PHX_ERROR_CLASS = \"phx-error\"\nconst PHX_PARENT_ID = \"data-phx-parent-id\"\nconst PHX_VIEW_SELECTOR = `[${PHX_VIEW}]`\nconst PHX_MAIN = `data-phx-main`\nconst PHX_ROOT_ID = `data-phx-root-id`\nconst PHX_TRIGGER_ACTION = \"trigger-action\"\nconst PHX_FEEDBACK_FOR = \"feedback-for\"\nconst PHX_HAS_FOCUSED = \"phx-has-focused\"\nconst FOCUSABLE_INPUTS = [\"text\", \"textarea\", \"number\", \"email\", \"password\", \"search\", \"tel\", \"url\", \"date\", \"time\"]\nconst CHECKABLE_INPUTS = [\"checkbox\", \"radio\"]\nconst PHX_HAS_SUBMITTED = \"phx-has-submitted\"\nconst PHX_SESSION = \"data-phx-session\"\nconst PHX_STATIC = \"data-phx-static\"\nconst PHX_READONLY = \"data-phx-readonly\"\nconst PHX_DISABLED = \"data-phx-disabled\"\nconst PHX_DISABLE_WITH = \"disable-with\"\nconst PHX_DISABLE_WITH_RESTORE = \"data-phx-disable-with-restore\"\nconst PHX_HOOK = \"hook\"\nconst PHX_DEBOUNCE = \"debounce\"\nconst PHX_THROTTLE = \"throttle\"\nconst PHX_UPDATE = \"update\"\nconst PHX_KEY = \"key\"\nconst PHX_PRIVATE = \"phxPrivate\"\nconst PHX_AUTO_RECOVER = \"auto-recover\"\nconst PHX_LV_DEBUG = \"phx:live-socket:debug\"\nconst PHX_LV_PROFILE = \"phx:live-socket:profiling\"\nconst PHX_LV_LATENCY_SIM = \"phx:live-socket:latency-sim\"\nconst PHX_PROGRESS = \"progress\"\nconst LOADER_TIMEOUT = 1\nconst BEFORE_UNLOAD_LOADER_TIMEOUT = 200\nconst BINDING_PREFIX = \"phx-\"\nconst PUSH_TIMEOUT = 30000\nconst LINK_HEADER = \"x-requested-with\"\nconst RESPONSE_URL_HEADER = \"x-response-url\"\nconst DEBOUNCE_TRIGGER = \"debounce-trigger\"\nconst THROTTLED = \"throttled\"\nconst DEBOUNCE_PREV_KEY = \"debounce-prev-key\"\nconst DEFAULTS = {\n  debounce: 300,\n  throttle: 300\n}\n\n// Rendered\nconst DYNAMICS = \"d\"\nconst STATIC = \"s\"\nconst COMPONENTS = \"c\"\nconst EVENTS = \"e\"\nconst REPLY = \"r\"\nconst TITLE = \"t\"\n\n\nlet logError = (msg, obj) => console.error && console.error(msg, obj)\n\nfunction detectDuplicateIds() {\n  let ids = new Set()\n  let elems = document.querySelectorAll('*[id]')\n  for (let i = 0, len = elems.length; i < len; i++) {\n    if (ids.has(elems[i].id)) {\n      console.error(`Multiple IDs detected: ${elems[i].id}. Ensure unique element ids.`)\n    } else {\n      ids.add(elems[i].id)\n    }\n  }\n}\n\nexport let debug = (view, kind, msg, obj) => {\n  if(view.liveSocket.isDebugEnabled()){\n    console.log(`${view.id} ${kind}: ${msg} - `, obj)\n  }\n}\n\n// wraps value in closure or returns closure\nlet closure = (val) => typeof val === \"function\" ? val : function(){ return val }\n\nlet clone = (obj) => { return JSON.parse(JSON.stringify(obj)) }\n\nlet closestPhxBinding = (el, binding, borderEl) => {\n  do {\n    if(el.matches(`[${binding}]`)){ return el }\n    el = el.parentElement || el.parentNode\n  } while(el !== null && el.nodeType === 1 && !((borderEl && borderEl.isSameNode(el)) || el.matches(PHX_VIEW_SELECTOR)))\n  return null\n}\n\nlet isObject = (obj) => {\n  return obj !== null && typeof obj === \"object\" && !(obj instanceof Array)\n}\n\nlet isEqualObj = (obj1, obj2) =>  JSON.stringify(obj1) === JSON.stringify(obj2)\n\nlet isEmpty = (obj) => {\n  for (let x in obj){ return false }\n  return true\n}\n\nlet maybe = (el, callback) => el && callback(el)\n\nclass UploadEntry {\n  static isActive(fileEl, file){\n    let isNew = file._phxRef === undefined\n    let activeRefs = fileEl.getAttribute(PHX_ACTIVE_ENTRY_REFS).split(\",\")\n    let isActive = activeRefs.indexOf(LiveUploader.genFileRef(file)) >= 0\n    return file.size > 0 && (isNew || isActive)\n  }\n\n  static isPreflighted(fileEl, file){\n    let preflightedRefs = fileEl.getAttribute(PHX_PREFLIGHTED_REFS).split(\",\")\n    let isPreflighted = preflightedRefs.indexOf(LiveUploader.genFileRef(file)) >= 0\n    return isPreflighted && this.isActive(fileEl, file)\n  }\n\n  constructor(fileEl, file, view){\n    this.ref = LiveUploader.genFileRef(file)\n    this.fileEl = fileEl\n    this.file = file\n    this.view = view\n    this.meta = null\n    this._isCancelled = false\n    this._isDone = false\n    this._progress = 0\n    this._lastProgressSent = -1\n    this._onDone = function(){}\n  }\n\n  metadata(){ return this.meta }\n\n  progress(progress){\n    this._progress = Math.floor(progress)\n    if(this._progress > this._lastProgressSent){\n      if(this._progress >= 100){\n        this._progress = 100\n        this._lastProgressSent = 100\n        this._isDone = true\n        this.view.pushFileProgress(this.fileEl, this.ref, 100, () => {\n          LiveUploader.untrackFile(this.fileEl, this.file)\n          this._onDone()\n        })\n      } else {\n        this._lastProgressSent = this._progress\n        this.view.pushFileProgress(this.fileEl, this.ref, this._progress)\n      }\n    }\n  }\n\n  cancel(){\n    this._isCancelled = true\n    this._isDone = true\n    this._onDone()\n  }\n\n  isDone(){ return this._isDone }\n\n  error(reason = \"failed\"){\n    LiveUploader.clearFiles(this.fileEl)\n    this.view.pushFileProgress(this.fileEl, this.ref, {error: reason})\n  }\n\n  //private\n\n  onDone(callback){ this._onDone = callback }\n\n  toPreflightPayload(){\n    return {\n      last_modified: this.file.lastModified,\n      name: this.file.name,\n      size: this.file.size,\n      type: this.file.type,\n      ref: this.ref\n    }\n  }\n\n  uploader(uploaders){\n    if(this.meta.uploader){\n      let callback = uploaders[this.meta.uploader] || logError(`no uploader configured for ${this.meta.uploader}`)\n      return {name: this.meta.uploader, callback: callback}\n    } else {\n      return {name: \"channel\", callback: channelUploader}\n    }\n  }\n\n  zipPostFlight(resp){\n    this.meta = resp.entries[this.ref]\n    if(!this.meta){ logError(`no preflight upload response returned with ref ${this.ref}`, {input: this.fileEl, response: resp})}\n  }\n}\n\nlet Hooks = {}\nHooks.LiveFileUpload = {\n  preflightedRefs(){ return this.el.getAttribute(PHX_PREFLIGHTED_REFS) },\n\n  mounted(){ this.preflightedWas = this.preflightedRefs() },\n\n  updated() {\n    let newPreflights = this.preflightedRefs()\n    if(this.preflightedWas !== newPreflights){\n      this.preflightedWas = newPreflights\n      if(newPreflights === \"\"){\n        this.__view.cancelSubmit(this.el.form)\n      }\n    }\n  }\n}\n\nHooks.LiveImgPreview = {\n  mounted() {\n    this.ref = this.el.getAttribute(\"data-phx-entry-ref\")\n    this.inputEl = document.getElementById(this.el.getAttribute(PHX_UPLOAD_REF))\n    LiveUploader.getEntryDataURL(this.inputEl, this.ref, url => this.el.src = url)\n  }\n}\n\nlet liveUploaderFileRef = 0\nclass LiveUploader {\n  static genFileRef(file){\n    let ref = file._phxRef\n    if(ref !== undefined){\n      return ref\n    } else {\n      file._phxRef = (liveUploaderFileRef++).toString()\n      return file._phxRef\n    }\n  }\n\n  static getEntryDataURL(inputEl, ref, callback){\n    let file = this.activeFiles(inputEl).find(file => this.genFileRef(file) === ref)\n    let reader = new FileReader()\n    reader.onload = (e) => callback(e.target.result)\n    reader.readAsDataURL(file)\n  }\n\n  static hasUploadsInProgress(formEl){\n    let active = 0\n    DOM.findUploadInputs(formEl).forEach(input => {\n      if(input.getAttribute(PHX_PREFLIGHTED_REFS) !== input.getAttribute(PHX_DONE_REFS)){\n        active++\n      }\n    })\n    return active > 0\n  }\n\n  static serializeUploads(inputEl){\n    let files = this.activeFiles(inputEl, \"serialize\")\n    let fileData = {}\n    files.forEach(file => {\n      let entry = {path: inputEl.name}\n      let uploadRef = inputEl.getAttribute(PHX_UPLOAD_REF)\n      fileData[uploadRef] = fileData[uploadRef] || []\n      entry.ref = this.genFileRef(file)\n      entry.name = file.name\n      entry.type = file.type\n      entry.size = file.size\n      fileData[uploadRef].push(entry)\n    })\n    return fileData\n  }\n\n  static clearFiles(inputEl){\n    inputEl.value = null\n    inputEl.removeAttribute(PHX_UPLOAD_REF)\n    DOM.putPrivate(inputEl, \"files\", [])\n  }\n\n  static untrackFile(inputEl, file){\n    DOM.putPrivate(inputEl, \"files\", DOM.private(inputEl, \"files\").filter(f => !Object.is(f, file)))\n  }\n\n  static trackFiles(inputEl, files){\n    if(inputEl.getAttribute(\"multiple\") !== null){\n      let newFiles = files.filter(file => !this.activeFiles(inputEl).find(f => Object.is(f, file)))\n      DOM.putPrivate(inputEl, \"files\", this.activeFiles(inputEl).concat(newFiles))\n      inputEl.value = null\n    } else {\n      DOM.putPrivate(inputEl, \"files\", files)\n    }\n  }\n\n  static activeFileInputs(formEl){\n    let fileInputs = DOM.findUploadInputs(formEl)\n    return Array.from(fileInputs).filter(el => el.files && this.activeFiles(el).length > 0)\n  }\n\n  static activeFiles(input){\n    return (DOM.private(input, \"files\") || []).filter(f => UploadEntry.isActive(input, f))\n  }\n\n  static inputsAwaitingPreflight(formEl){\n    let fileInputs = DOM.findUploadInputs(formEl)\n    return Array.from(fileInputs).filter(input => this.filesAwaitingPreflight(input).length > 0)\n  }\n\n  static filesAwaitingPreflight(input){\n    return this.activeFiles(input).filter(f => !UploadEntry.isPreflighted(input, f))\n  }\n\n  constructor(inputEl, view, onComplete){\n    this.view = view\n    this.onComplete = onComplete\n    this._entries =\n      Array.from(LiveUploader.filesAwaitingPreflight(inputEl) || [])\n        .map(file => new UploadEntry(inputEl, file, view))\n\n    this.numEntriesInProgress = this._entries.length\n  }\n\n  entries(){ return this._entries }\n\n  initAdapterUpload(resp, onError, liveSocket){\n    this._entries =\n      this._entries.map(entry => {\n        entry.zipPostFlight(resp)\n        entry.onDone(() => {\n          this.numEntriesInProgress--\n          if(this.numEntriesInProgress === 0){ this.onComplete() }\n        })\n        return entry\n      })\n\n    let groupedEntries = this._entries.reduce((acc, entry) => {\n      let {name, callback} = entry.uploader(liveSocket.uploaders)\n      acc[name] = acc[name] || {callback: callback, entries: []}\n      acc[name].entries.push(entry)\n      return acc\n    }, {})\n\n    for(let name in groupedEntries){\n      let {callback, entries} = groupedEntries[name]\n      callback(entries, onError, resp, liveSocket)\n    }\n  }\n}\n\nlet channelUploader = function(entries, onError, resp, liveSocket){\n  entries.forEach(entry => {\n    let entryUploader = new EntryUploader(entry, resp.config.chunk_size, liveSocket)\n    entryUploader.upload()\n  })\n}\n\nclass EntryUploader {\n  constructor(entry, chunkSize, liveSocket){\n    this.liveSocket = liveSocket\n    this.entry = entry\n    this.offset = 0\n    this.chunkSize = chunkSize\n    this.chunkTimer = null\n    this.uploadChannel = liveSocket.channel(`lvu:${entry.ref}`, {token: entry.metadata()})\n  }\n\n  error(reason){\n    clearTimeout(this.chunkTimer)\n    this.uploadChannel.leave()\n    this.entry.error(reason)\n  }\n\n  upload(){\n    this.uploadChannel.onError(reason => this.error(reason))\n    this.uploadChannel.join()\n      .receive(\"ok\", data => this.readNextChunk())\n      .receive(\"error\", reason => this.error(reason))\n  }\n\n  isDone(){ return this.offset >= this.entry.file.size }\n\n  readNextChunk(){\n    let reader = new window.FileReader()\n    let blob = this.entry.file.slice(this.offset, this.chunkSize + this.offset)\n    reader.onload = (e) => {\n      if(e.target.error === null){\n        this.offset += e.target.result.byteLength\n        this.pushChunk(e.target.result)\n      } else {\n        return logError(\"Read error: \" + e.target.error)\n      }\n    }\n    reader.readAsArrayBuffer(blob)\n  }\n\n  pushChunk(chunk){\n    if(!this.uploadChannel.isJoined()){ return }\n    this.uploadChannel.push(\"chunk\", chunk)\n      .receive(\"ok\", () => {\n        this.entry.progress((this.offset / this.entry.file.size) * 100)\n        if(!this.isDone()){\n          this.chunkTimer = setTimeout(() => this.readNextChunk(), this.liveSocket.getLatencySim() || 0)\n        }\n      })\n  }\n}\n\nlet serializeForm = (form, meta = {}) => {\n  let formData = new FormData(form)\n  let toRemove = []\n\n  formData.forEach((val, key, index) => {\n    if(val instanceof File){ toRemove.push(key) }\n  })\n\n  // Cleanup after building fileData\n  toRemove.forEach(key => formData.delete(key))\n\n  let params = new URLSearchParams()\n  for(let [key, val] of formData.entries()){ params.append(key, val) }\n  for(let metaKey in meta){ params.append(metaKey, meta[metaKey]) }\n\n  return params.toString()\n}\n\nexport class Rendered {\n  static extract(diff){\n    let {[REPLY]: reply, [EVENTS]: events, [TITLE]: title} = diff\n    delete diff[REPLY]\n    delete diff[EVENTS]\n    delete diff[TITLE]\n    return {diff, title, reply: reply || null, events: events || []}\n  }\n\n  constructor(viewId, rendered){\n    this.viewId = viewId\n    this.rendered = {}\n    this.mergeDiff(rendered)\n  }\n\n  parentViewId(){ return this.viewId }\n\n  toString(onlyCids){\n    return this.recursiveToString(this.rendered, this.rendered[COMPONENTS], onlyCids)\n  }\n\n  recursiveToString(rendered, components = rendered[COMPONENTS], onlyCids){\n    onlyCids = onlyCids ? new Set(onlyCids) : null\n    let output = {buffer: \"\", components: components, onlyCids: onlyCids}\n    this.toOutputBuffer(rendered, output)\n    return output.buffer\n  }\n\n  componentCIDs(diff){ return Object.keys(diff[COMPONENTS] || {}).map(i => parseInt(i)) }\n\n  isComponentOnlyDiff(diff){\n    if(!diff[COMPONENTS]){ return false }\n    return Object.keys(diff).length === 1\n  }\n\n  getComponent(diff, cid){ return diff[COMPONENTS][cid] }\n\n  mergeDiff(diff){\n    let newc = diff[COMPONENTS]\n    let cache = {}\n    delete diff[COMPONENTS]\n    this.rendered = this.mutableMerge(this.rendered, diff)\n    this.rendered[COMPONENTS] = this.rendered[COMPONENTS] || {}\n\n    if(newc){\n      let oldc = this.rendered[COMPONENTS]\n\n      for(let cid in newc){\n        newc[cid] = this.cachedFindComponent(cid, newc[cid], oldc, newc, cache)\n      }\n\n      for (var key in newc) { oldc[key] = newc[key] }\n      diff[COMPONENTS] = newc\n    }\n  }\n\n  cachedFindComponent(cid, cdiff, oldc, newc, cache) {\n    if(cache[cid]) {\n      return cache[cid]\n    } else {\n      let ndiff, stat, scid = cdiff[STATIC]\n\n      if(typeof(scid) === \"number\") {\n        let tdiff\n\n        if(scid > 0) {\n          tdiff = this.cachedFindComponent(scid, newc[scid], oldc, newc, cache)\n        } else {\n          tdiff = oldc[-scid]\n        }\n\n        stat = tdiff[STATIC]\n        ndiff = this.cloneMerge(tdiff, cdiff)\n        ndiff[STATIC] = stat\n      } else {\n        ndiff = cdiff[STATIC] !== undefined ? cdiff : this.cloneMerge(oldc[cid] || {}, cdiff)\n      }\n\n      cache[cid] = ndiff\n      return ndiff\n    }\n  }\n\n  mutableMerge(target, source){\n    if(source[STATIC] !== undefined){\n      return source\n    } else {\n      this.doMutableMerge(target, source)\n      return target\n    }\n  }\n\n  doMutableMerge(target, source){\n    for(let key in source){\n      let val = source[key]\n      let targetVal = target[key]\n      if(isObject(val) && val[STATIC] === undefined && isObject(targetVal)){\n        this.doMutableMerge(targetVal, val)\n      } else {\n        target[key] = val\n      }\n    }\n  }\n\n  cloneMerge(target, source){\n    let merged = {...target, ...source}\n    for(let key in merged){\n      let val = source[key]\n      let targetVal = target[key]\n      if(isObject(val) && val[STATIC] === undefined && isObject(targetVal)){\n        merged[key] = this.cloneMerge(targetVal, val)\n      }\n    }\n    return merged\n  }\n\n  componentToString(cid){ return this.recursiveCIDToString(this.rendered[COMPONENTS], cid) }\n\n  pruneCIDs(cids){\n    cids.forEach(cid => delete this.rendered[COMPONENTS][cid])\n  }\n\n  // private\n\n  get(){ return this.rendered }\n\n  isNewFingerprint(diff = {}){ return !!diff[STATIC] }\n\n  toOutputBuffer(rendered, output){\n    if(rendered[DYNAMICS]){ return this.comprehensionToBuffer(rendered, output) }\n    let {[STATIC]: statics} = rendered\n\n    output.buffer += statics[0]\n    for(let i = 1; i < statics.length; i++){\n      this.dynamicToBuffer(rendered[i - 1], output)\n      output.buffer += statics[i]\n    }\n  }\n\n  comprehensionToBuffer(rendered, output){\n    let {[DYNAMICS]: dynamics, [STATIC]: statics} = rendered\n\n    for(let d = 0; d < dynamics.length; d++){\n      let dynamic = dynamics[d]\n      output.buffer += statics[0]\n      for(let i = 1; i < statics.length; i++){\n        this.dynamicToBuffer(dynamic[i - 1], output)\n        output.buffer += statics[i]\n      }\n    }\n  }\n\n  dynamicToBuffer(rendered, output){\n    if(typeof(rendered) === \"number\"){\n      output.buffer += this.recursiveCIDToString(output.components, rendered, output.onlyCids)\n   } else if(isObject(rendered)){\n      this.toOutputBuffer(rendered, output)\n    } else {\n      output.buffer += rendered\n    }\n  }\n\n  recursiveCIDToString(components, cid, onlyCids){\n    let component = components[cid] || logError(`no component for CID ${cid}`, components)\n    let template = document.createElement(\"template\")\n    template.innerHTML = this.recursiveToString(component, components, onlyCids)\n    let container = template.content\n    let skip = onlyCids && !onlyCids.has(cid)\n\n    let [hasChildNodes, hasChildComponents] =\n      Array.from(container.childNodes).reduce(([hasNodes, hasComponents], child, i) => {\n        if(child.nodeType === Node.ELEMENT_NODE){\n          if(child.getAttribute(PHX_COMPONENT)){\n            return [hasNodes, true]\n          }\n          child.setAttribute(PHX_COMPONENT, cid)\n          if(!child.id){ child.id = `${this.parentViewId()}-${cid}-${i}`}\n          if(skip){\n            child.setAttribute(PHX_SKIP, \"\")\n            child.innerHTML = \"\"\n          }\n          return [true, hasComponents]\n        } else {\n          if(child.nodeValue.trim() !== \"\"){\n            logError(`only HTML element tags are allowed at the root of components.\\n\\n` +\n                    `got: \"${child.nodeValue.trim()}\"\\n\\n` +\n                    `within:\\n`, template.innerHTML.trim())\n            child.replaceWith(this.createSpan(child.nodeValue, cid))\n            return [true, hasComponents]\n          } else {\n            child.remove()\n            return [hasNodes, hasComponents]\n          }\n        }\n      }, [false, false])\n\n    if(!hasChildNodes && !hasChildComponents){\n      logError(`expected at least one HTML element tag inside a component, but the component is empty:\\n`,\n               template.innerHTML.trim())\n      return this.createSpan(\"\", cid).outerHTML\n    } else if(!hasChildNodes && hasChildComponents){\n      logError(`expected at least one HTML element tag directly inside a component, but only subcomponents were found. A component must render at least one HTML tag directly inside itself.`,\n               template.innerHTML.trim())\n      return template.innerHTML\n    } else {\n      return template.innerHTML\n    }\n  }\n\n  createSpan(text, cid) {\n    let span = document.createElement(\"span\")\n    span.innerText = text\n    span.setAttribute(PHX_COMPONENT, cid)\n    return span\n  }\n}\n\n/** Initializes the LiveSocket\n *\n *\n * @param {string} endPoint - The string WebSocket endpoint, ie, `\"wss://example.com/live\"`,\n *                                               `\"/live\"` (inherited host & protocol)\n * @param {Phoenix.Socket} socket - the required Phoenix Socket class imported from \"phoenix\". For example:\n *\n *     import {Socket} from \"phoenix\"\n *     import {LiveSocket} from \"phoenix_live_view\"\n *     let liveSocket = new LiveSocket(\"/live\", Socket, {...})\n *\n * @param {Object} [opts] - Optional configuration. Outside of keys listed below, all\n * configuration is passed directly to the Phoenix Socket constructor.\n * @param {Object} [opts.defaults] - The optional defaults to use for various bindings,\n * such as `phx-debounce`. Supports the following keys:\n *\n *   - debounce - the millisecond phx-debounce time. Defaults 300\n *   - throttle - the millisecond phx-throttle time. Defaults 300\n *\n * @param {Function} [opts.params] - The optional function for passing connect params.\n * The function receives the viewName associated with a given LiveView. For example:\n *\n *     (viewName) => {view: viewName, token: window.myToken}\n *\n * @param {string} [opts.bindingPrefix] - The optional prefix to use for all phx DOM annotations.\n * Defaults to \"phx-\".\n * @param {Object} [opts.hooks] - The optional object for referencing LiveView hook callbacks.\n * @param {Object} [opts.uploaders] - The optional object for referencing LiveView uploader callbacks.\n * @param {integer} [opts.loaderTimeout] - The optional delay in milliseconds to wait before apply\n * loading states.\n * @param {Function} [opts.viewLogger] - The optional function to log debug information. For example:\n *\n *     (view, kind, msg, obj) => console.log(`${view.id} ${kind}: ${msg} - `, obj)\n *\n * @param {Object} [opts.metadata] - The optional object mapping event names to functions for\n * populating event metadata. For example:\n *\n *     metadata: {\n *       click: (e, el) => {\n *         return {\n *           ctrlKey: e.ctrlKey,\n *           metaKey: e.metaKey,\n *           detail: e.detail || 1,\n *         }\n *       },\n *       keydown: (e, el) => {\n *         return {\n *           key: e.key,\n *           ctrlKey: e.ctrlKey,\n *           metaKey: e.metaKey,\n *           shiftKey: e.shiftKey\n *         }\n *       }\n *     }\n * @param {Object} [opts.sessionStorage] - An optional Storage compatible object\n * Useful when LiveView won't have access to `sessionStorage`.  For example, This could\n * happen if a site loads a cross-domain LiveView in an iframe.  Example usage:\n *\n *     class InMemoryStorage {\n *       constructor() { this.storage = {} }\n *       getItem(keyName) { return this.storage[keyName] }\n *       removeItem(keyName) { delete this.storage[keyName] }\n *       setItem(keyName, keyValue) { this.storage[keyName] = keyValue }\n *     }\n *\n * @param {Object} [opts.localStorage] - An optional Storage compatible object\n * Useful for when LiveView won't have access to `localStorage`.\n * See `opts.sessionStorage` for examples.\n*/\nexport class LiveSocket {\n  constructor(url, phxSocket, opts = {}){\n    this.unloaded = false\n    if(!phxSocket || phxSocket.constructor.name === \"Object\"){\n      throw new Error(`\n      a phoenix Socket must be provided as the second argument to the LiveSocket constructor. For example:\n\n          import {Socket} from \"phoenix\"\n          import {LiveSocket} from \"phoenix_live_view\"\n          let liveSocket = new LiveSocket(\"/live\", Socket, {...})\n      `)\n    }\n    this.socket = new phxSocket(url, opts)\n    this.bindingPrefix = opts.bindingPrefix || BINDING_PREFIX\n    this.opts = opts\n    this.params = closure(opts.params || {})\n    this.viewLogger = opts.viewLogger\n    this.metadataCallbacks = opts.metadata || {}\n    this.defaults = Object.assign(clone(DEFAULTS), opts.defaults || {})\n    this.activeElement = null\n    this.prevActive = null\n    this.silenced = false\n    this.main = null\n    this.linkRef = 1\n    this.roots = {}\n    this.href = window.location.href\n    this.pendingLink = null\n    this.currentLocation = clone(window.location)\n    this.hooks = opts.hooks || {}\n    this.uploaders = opts.uploaders || {}\n    this.loaderTimeout = opts.loaderTimeout || LOADER_TIMEOUT\n    this.localStorage = opts.localStorage || window.localStorage\n    this.sessionStorage = opts.sessionStorage || window.sessionStorage\n    this.boundTopLevelEvents = false\n    this.domCallbacks = Object.assign({onNodeAdded: closure(), onBeforeElUpdated: closure()}, opts.dom || {})\n    window.addEventListener(\"pagehide\", e => {\n      this.unloaded = true\n    })\n    this.socket.onOpen(() => {\n      if(this.isUnloaded()){\n        // reload page if being restored from back/forward cache and browser does not emit \"pageshow\"\n        window.location.reload()\n      }\n    })\n  }\n\n  // public\n\n  isProfileEnabled(){ return this.sessionStorage.getItem(PHX_LV_PROFILE) === \"true\" }\n\n  isDebugEnabled(){ return this.sessionStorage.getItem(PHX_LV_DEBUG) === \"true\" }\n\n  enableDebug(){ this.sessionStorage.setItem(PHX_LV_DEBUG, \"true\") }\n\n  enableProfiling(){ this.sessionStorage.setItem(PHX_LV_PROFILE, \"true\") }\n\n  disableDebug(){ this.sessionStorage.removeItem(PHX_LV_DEBUG) }\n\n  disableProfiling(){ this.sessionStorage.removeItem(PHX_LV_PROFILE) }\n\n  enableLatencySim(upperBoundMs){\n    this.enableDebug()\n    console.log(\"latency simulator enabled for the duration of this browser session. Call disableLatencySim() to disable\")\n    this.sessionStorage.setItem(PHX_LV_LATENCY_SIM, upperBoundMs)\n  }\n\n  disableLatencySim(){ this.sessionStorage.removeItem(PHX_LV_LATENCY_SIM) }\n\n  getLatencySim(){\n    let str = this.sessionStorage.getItem(PHX_LV_LATENCY_SIM)\n    return str ? parseInt(str) : null\n  }\n\n  getSocket(){ return this.socket }\n\n  connect(){\n    let doConnect = () => {\n      if(this.joinRootViews()){\n        this.bindTopLevelEvents()\n        this.socket.connect()\n      }\n    }\n    if([\"complete\", \"loaded\",\"interactive\"].indexOf(document.readyState) >= 0){\n      doConnect()\n    } else {\n      document.addEventListener(\"DOMContentLoaded\", () => doConnect())\n    }\n  }\n\n  disconnect(callback){ this.socket.disconnect(callback) }\n\n  // private\n\n  triggerDOM(kind, args){ this.domCallbacks[kind](...args) }\n\n  time(name, func){\n    if(!this.isProfileEnabled() || !console.time){ return func() }\n    console.time(name)\n    let result = func()\n    console.timeEnd(name)\n    return result\n  }\n\n  log(view, kind, msgCallback){\n    if(this.viewLogger){\n      let [msg, obj] = msgCallback()\n      this.viewLogger(view, kind, msg, obj)\n    } else if(this.isDebugEnabled()){\n      let [msg, obj] = msgCallback()\n      debug(view, kind, msg, obj)\n    }\n  }\n\n  onChannel(channel, event, cb){\n    channel.on(event, data => {\n      let latency = this.getLatencySim()\n      if(!latency){\n        cb(data)\n      } else {\n        console.log(`simulating ${latency}ms of latency from server to client`)\n        setTimeout(() => cb(data), latency)\n      }\n    })\n  }\n\n  wrapPush(view, opts, push){\n    let latency = this.getLatencySim()\n    let oldJoinCount = view.joinCount\n    if(!latency){\n      if(opts.timeout){\n        return push().receive(\"timeout\", () => {\n          if(view.joinCount === oldJoinCount){\n            this.reloadWithJitter(view, () => {\n              this.log(view, \"timeout\", () => [`received timeout while communicating with server. Falling back to hard refresh for recovery`])\n            })\n          }\n        })\n      } else {\n        return push()\n      }\n    }\n\n    console.log(`simulating ${latency}ms of latency from client to server`)\n    let fakePush = {\n      receives: [],\n      receive(kind, cb){ this.receives.push([kind, cb])}\n    }\n    setTimeout(() => {\n      fakePush.receives.reduce((acc, [kind, cb]) => acc.receive(kind, cb), push())\n    }, latency)\n    return fakePush\n  }\n\n  reloadWithJitter(view, log){\n    view.destroy()\n    this.disconnect()\n    let [minMs, maxMs] = RELOAD_JITTER\n    let afterMs = Math.floor(Math.random() * (maxMs - minMs + 1)) + minMs\n    let tries = Browser.updateLocal(this.localStorage, view.name(), CONSECUTIVE_RELOADS, 0, count => count + 1)\n    log ? log() : this.log(view, \"join\", () => [`encountered ${tries} consecutive reloads`])\n    if(tries > MAX_RELOADS){\n      this.log(view, \"join\", () => [`exceeded ${MAX_RELOADS} consecutive reloads. Entering failsafe mode`])\n      afterMs = FAILSAFE_JITTER\n    }\n    setTimeout(() => {\n      if(this.hasPendingLink()){\n        window.location = this.pendingLink\n      } else {\n        window.location.reload()\n      }\n    }, afterMs)\n  }\n\n  getHookCallbacks(name){\n    return name && name.startsWith(\"Phoenix.\") ? Hooks[name.split(\".\")[1]] : this.hooks[name]\n  }\n\n  isUnloaded(){ return this.unloaded }\n\n  isConnected(){ return this.socket.isConnected() }\n\n  getBindingPrefix(){ return this.bindingPrefix }\n\n  binding(kind){ return `${this.getBindingPrefix()}${kind}` }\n\n  channel(topic, params){ return this.socket.channel(topic, params) }\n\n  joinRootViews(){\n    let rootsFound = false\n    DOM.all(document, `${PHX_VIEW_SELECTOR}:not([${PHX_PARENT_ID}])`, rootEl => {\n      if(!this.getRootById(rootEl.id)){\n        let view = this.joinRootView(rootEl, this.getHref())\n        this.root = this.root || view\n        if(rootEl.getAttribute(PHX_MAIN)){ this.main = view }\n      }\n      rootsFound = true\n    })\n    return rootsFound\n  }\n\n  redirect(to, flash){\n    this.disconnect()\n    Browser.redirect(to, flash)\n  }\n\n  replaceMain(href, flash, callback = null, linkRef = this.setPendingLink(href)){\n    let mainEl = this.main.el\n    this.main.showLoader(this.loaderTimeout)\n    this.main.destroy()\n\n    Browser.fetchPage(href, (status, html) => {\n      if(status !== 200){ return this.redirect(href) }\n\n      let template = document.createElement(\"template\")\n      template.innerHTML = html\n      let el = template.content.childNodes[0]\n      if(!el || !this.isPhxView(el)){ return this.redirect(href) }\n\n      this.joinRootView(el, href, flash, (newMain, joinCount) => {\n        if(joinCount !== 1){ return }\n        if(!this.commitPendingLink(linkRef)){\n          newMain.destroy()\n          return\n        }\n        mainEl.replaceWith(newMain.el)\n        this.main = newMain\n        callback && callback()\n      })\n    })\n  }\n\n  isPhxView(el){ return el.getAttribute && el.getAttribute(PHX_VIEW) !== null }\n\n  joinRootView(el, href, flash, callback){\n    let view = new View(el, this, null, href, flash)\n    this.roots[view.id] = view\n    view.join(callback)\n    return view\n  }\n\n  owner(childEl, callback){\n    let view = maybe(childEl.closest(PHX_VIEW_SELECTOR), el => this.getViewByEl(el))\n    if(view){ callback(view) }\n  }\n\n  withinOwners(childEl, callback){\n    this.owner(childEl, view => {\n      let phxTarget = childEl.getAttribute(this.binding(\"target\"))\n      if(phxTarget === null){\n        callback(view, childEl)\n      } else {\n        view.withinTargets(phxTarget, callback)\n      }\n    })\n  }\n\n  getViewByEl(el){\n    let rootId = el.getAttribute(PHX_ROOT_ID)\n    return maybe(this.getRootById(rootId), root => root.getDescendentByEl(el))\n  }\n\n  getRootById(id){ return this.roots[id] }\n\n  destroyAllViews(){\n    for(let id in this.roots){\n      this.roots[id].destroy()\n      delete this.roots[id]\n    }\n  }\n\n  destroyViewByEl(el){\n    let root = this.getRootById(el.getAttribute(PHX_ROOT_ID))\n    if(root){ root.destroyDescendent(el.id) }\n  }\n\n  setActiveElement(target){\n    if(this.activeElement === target){ return }\n    this.activeElement = target\n    let cancel = () => {\n      if(target === this.activeElement){ this.activeElement = null }\n      target.removeEventListener(\"mouseup\", this)\n      target.removeEventListener(\"touchend\", this)\n    }\n    target.addEventListener(\"mouseup\", cancel)\n    target.addEventListener(\"touchend\", cancel)\n  }\n\n  getActiveElement(){\n    if(document.activeElement === document.body){\n      return this.activeElement || document.activeElement\n    } else {\n      // document.activeElement can be null in Internet Explorer 11\n      return document.activeElement || document.body;\n    }\n  }\n\n  dropActiveElement(view){\n    if(this.prevActive && view.ownsElement(this.prevActive)){\n      this.prevActive = null\n    }\n  }\n\n  restorePreviouslyActiveFocus(){\n    if(this.prevActive && this.prevActive !== document.body){\n      this.prevActive.focus()\n    }\n  }\n\n  blurActiveElement(){\n    this.prevActive = this.getActiveElement()\n    if(this.prevActive !== document.body){ this.prevActive.blur() }\n  }\n\n  bindTopLevelEvents(){\n    if(this.boundTopLevelEvents){ return }\n\n    this.boundTopLevelEvents = true\n    document.body.addEventListener(\"click\", function(){}) // ensure all click events bubble for mobile Safari\n    window.addEventListener(\"pageshow\", e => {\n      if(e.persisted){ // reload page if being restored from back/forward cache\n        this.getSocket().disconnect()\n        this.withPageLoading({to: window.location.href, kind: \"redirect\"})\n        window.location.reload()\n      }\n    }, true)\n    this.bindClicks()\n    this.bindNav()\n    this.bindForms()\n    this.bind({keyup: \"keyup\", keydown: \"keydown\"}, (e, type, view, target, targetCtx, phxEvent, phxTarget) => {\n      let matchKey = target.getAttribute(this.binding(PHX_KEY))\n      let pressedKey = e.key && e.key.toLowerCase() // chrome clicked autocompletes send a keydown without key\n      if(matchKey && matchKey.toLowerCase() !== pressedKey){ return }\n\n      view.pushKey(target, targetCtx, type, phxEvent, {key: e.key, ...this.eventMeta(type, e, target)})\n    })\n    this.bind({blur: \"focusout\", focus: \"focusin\"}, (e, type, view, targetEl, targetCtx, phxEvent, phxTarget) => {\n      if(!phxTarget){\n        view.pushEvent(type, targetEl, targetCtx, phxEvent, this.eventMeta(type, e, targetEl))\n      }\n    })\n    this.bind({blur: \"blur\", focus: \"focus\"}, (e, type, view, targetEl, targetCtx, phxEvent, phxTarget) => {\n      // blur and focus are triggered on document and window. Discard one to avoid dups\n      if(phxTarget && !phxTarget !== \"window\"){\n        view.pushEvent(type, targetEl, targetCtx, phxEvent, this.eventMeta(type, e, targetEl))\n      }\n    })\n    window.addEventListener(\"dragover\", e => e.preventDefault())\n    window.addEventListener(\"drop\", e => {\n      e.preventDefault()\n      let dropTargetId = maybe(closestPhxBinding(e.target, this.binding(PHX_DROP_TARGET)), trueTarget => {\n        return trueTarget.getAttribute(this.binding(PHX_DROP_TARGET))\n      })\n      let dropTarget = dropTargetId && document.getElementById(dropTargetId)\n      let files = Array.from(e.dataTransfer.files || [])\n      if(!dropTarget || dropTarget.disabled || files.length === 0 || !(dropTarget.files instanceof FileList)){ return }\n\n      LiveUploader.trackFiles(dropTarget, files)\n      dropTarget.dispatchEvent(new Event(\"input\", {bubbles: true}))\n    })\n  }\n\n  eventMeta(eventName, e, targetEl){\n    let callback = this.metadataCallbacks[eventName]\n    return callback ? callback(e, targetEl) : {}\n  }\n\n  setPendingLink(href){\n    this.linkRef++\n    this.pendingLink = href\n    return this.linkRef\n  }\n\n  commitPendingLink(linkRef){\n    if(this.linkRef !== linkRef){\n      return false\n    } else {\n      this.href = this.pendingLink\n      this.pendingLink = null\n      return true\n    }\n  }\n\n  getHref(){ return this.href }\n\n  hasPendingLink(){ return !!this.pendingLink }\n\n  bind(events, callback){\n    for(let event in events){\n      let browserEventName = events[event]\n\n      this.on(browserEventName, e => {\n        let binding = this.binding(event)\n        let windowBinding = this.binding(`window-${event}`)\n        let targetPhxEvent = e.target.getAttribute && e.target.getAttribute(binding)\n        if(targetPhxEvent){\n          this.debounce(e.target, e, () => {\n            this.withinOwners(e.target, (view, targetCtx) => {\n              callback(e, event, view, e.target, targetCtx, targetPhxEvent, null)\n            })\n          })\n        } else {\n          DOM.all(document, `[${windowBinding}]`, el => {\n            let phxEvent = el.getAttribute(windowBinding)\n            this.debounce(el, e, () => {\n              this.withinOwners(el, (view, targetCtx) => {\n                callback(e, event, view, el, targetCtx, phxEvent, \"window\")\n              })\n            })\n          })\n        }\n      })\n    }\n  }\n\n  bindClicks(){\n    this.bindClick(\"click\", \"click\", false)\n    this.bindClick(\"mousedown\", \"capture-click\", true)\n  }\n\n  bindClick(eventName, bindingName, capture){\n    let click = this.binding(bindingName)\n    window.addEventListener(eventName, e => {\n      if(!this.isConnected()){ return }\n      let target = null\n      if(capture){\n        target = e.target.matches(`[${click}]`) ? e.target : e.target.querySelector(`[${click}]`)\n      } else {\n        target = closestPhxBinding(e.target, click)\n      }\n      let phxEvent = target && target.getAttribute(click)\n      if(!phxEvent){ return }\n      if(target.getAttribute(\"href\") === \"#\"){ e.preventDefault() }\n\n      this.debounce(target, e, () => {\n        this.withinOwners(target, (view, targetCtx) => {\n          view.pushEvent(\"click\", target, targetCtx, phxEvent, this.eventMeta(\"click\", e, target))\n        })\n      })\n    }, capture)\n  }\n\n  bindNav(){\n    if(!Browser.canPushState()){ return }\n    if(history.scrollRestoration){ history.scrollRestoration = \"manual\" }\n    let scrollTimer = null\n    window.addEventListener(\"scroll\", e => {\n      clearTimeout(scrollTimer)\n      scrollTimer = setTimeout(() => {\n        Browser.updateCurrentState(state => Object.assign(state, {scroll: window.scrollY}))\n      }, 100)\n    })\n    window.addEventListener(\"popstate\", event => {\n      if(!this.registerNewLocation(window.location)){ return }\n      let {type, id, root, scroll} = event.state || {}\n      let href = window.location.href\n\n      if(this.main.isConnected() && (type === \"patch\" && id  === this.main.id)){\n        this.main.pushLinkPatch(href, null)\n      } else {\n        this.replaceMain(href, null, () => {\n          if(root){ this.replaceRootHistory() }\n          if(typeof(scroll) === \"number\"){\n            setTimeout(() => {\n              window.scrollTo(0, scroll)\n            }, 0) // the body needs to render before we scroll.\n          }\n        })\n      }\n    }, false)\n    window.addEventListener(\"click\", e => {\n      let target = closestPhxBinding(e.target, PHX_LIVE_LINK)\n      let type = target && target.getAttribute(PHX_LIVE_LINK)\n      let wantsNewTab = e.metaKey || e.ctrlKey || e.button === 1\n      if(!type || !this.isConnected() || !this.main || wantsNewTab){ return }\n      let href = target.href\n      let linkState = target.getAttribute(PHX_LINK_STATE)\n      e.preventDefault()\n      if(this.pendingLink === href){ return }\n\n      if(type === \"patch\"){\n        this.pushHistoryPatch(href, linkState, target)\n      } else if(type === \"redirect\") {\n        this.historyRedirect(href, linkState)\n      } else {\n        throw new Error(`expected ${PHX_LIVE_LINK} to be \"patch\" or \"redirect\", got: ${type}`)\n      }\n    }, false)\n  }\n\n  withPageLoading(info, callback){\n    DOM.dispatchEvent(window, \"phx:page-loading-start\", info)\n    let done = () => DOM.dispatchEvent(window, \"phx:page-loading-stop\", info)\n    return callback ? callback(done) : done\n  }\n\n  pushHistoryPatch(href, linkState, targetEl){\n    this.withPageLoading({to: href, kind: \"patch\"}, done => {\n      this.main.pushLinkPatch(href, targetEl, linkRef => {\n        this.historyPatch(href, linkState, linkRef)\n        done()\n      })\n    })\n  }\n\n  historyPatch(href, linkState, linkRef = this.setPendingLink(href)){\n    if(!this.commitPendingLink(linkRef)){ return }\n\n    Browser.pushState(linkState, {type: \"patch\", id: this.main.id}, href)\n    this.registerNewLocation(window.location)\n  }\n\n  historyRedirect(href, linkState, flash){\n    let scroll = window.scrollY\n    this.withPageLoading({to: href, kind: \"redirect\"}, done => {\n      this.replaceMain(href, flash, () => {\n        Browser.pushState(linkState, {type: \"redirect\", id: this.main.id, scroll: scroll}, href)\n        this.registerNewLocation(window.location)\n        done()\n      })\n    })\n  }\n\n  replaceRootHistory(){\n    Browser.pushState(\"replace\", {root: true, type: \"patch\", id: this.main.id})\n  }\n\n  registerNewLocation(newLocation){\n    let {pathname, search} = this.currentLocation\n    if(pathname + search === newLocation.pathname + newLocation.search){\n      return false\n    } else {\n      this.currentLocation = clone(newLocation)\n      return true\n    }\n  }\n\n  bindForms(){\n    let iterations = 0\n    this.on(\"submit\", e => {\n      let phxEvent = e.target.getAttribute(this.binding(\"submit\"))\n      if(!phxEvent){ return }\n      e.preventDefault()\n      e.target.disabled = true\n      this.withinOwners(e.target, (view, targetCtx) => view.submitForm(e.target, targetCtx, phxEvent))\n    }, false)\n\n    for(let type of [\"change\", \"input\"]){\n      this.on(type, e => {\n        let input = e.target\n        let phxEvent = input.form && input.form.getAttribute(this.binding(\"change\"))\n        if(!phxEvent){ return }\n        if(input.type === \"number\" && input.validity && input.validity.badInput){ return }\n        let currentIterations = iterations\n        iterations++\n        let {at: at, type: lastType} = DOM.private(input, \"prev-iteration\") || {}\n        // detect dup because some browsers dispatch both \"input\" and \"change\"\n        if(at === currentIterations - 1 && type !== lastType){ return }\n\n        DOM.putPrivate(input, \"prev-iteration\", {at: currentIterations, type: type})\n\n        this.debounce(input, e, () => {\n          this.withinOwners(input.form, (view, targetCtx) => {\n            DOM.putPrivate(input, PHX_HAS_FOCUSED, true)\n            if(!DOM.isTextualInput(input)){\n              this.setActiveElement(input)\n            }\n            view.pushInput(input, targetCtx, phxEvent, e.target)\n          })\n        })\n      }, false)\n    }\n  }\n\n  debounce(el, event, callback){\n    let phxDebounce = this.binding(PHX_DEBOUNCE)\n    let phxThrottle = this.binding(PHX_THROTTLE)\n    let defaultDebounce = this.defaults.debounce.toString()\n    let defaultThrottle = this.defaults.throttle.toString()\n    DOM.debounce(el, event, phxDebounce, defaultDebounce, phxThrottle, defaultThrottle, callback)\n  }\n\n  silenceEvents(callback){\n    this.silenced = true\n    callback()\n    this.silenced = false\n  }\n\n  on(event, callback){\n    window.addEventListener(event, e => {\n      if(!this.silenced){ callback(e) }\n    })\n  }\n}\n\nexport let Browser = {\n  canPushState(){ return (typeof(history.pushState) !== \"undefined\") },\n\n  dropLocal(localStorage, namespace, subkey){\n    return localStorage.removeItem(this.localKey(namespace, subkey))\n  },\n\n  updateLocal(localStorage, namespace, subkey, initial, func){\n    let current = this.getLocal(localStorage, namespace, subkey)\n    let key = this.localKey(namespace, subkey)\n    let newVal = current === null ? initial : func(current)\n    localStorage.setItem(key, JSON.stringify(newVal))\n    return newVal\n  },\n\n  getLocal(localStorage, namespace, subkey){\n    return JSON.parse(localStorage.getItem(this.localKey(namespace, subkey)))\n  },\n\n  fetchPage(href, callback){\n    let req = new XMLHttpRequest()\n    req.open(\"GET\", href, true)\n    req.timeout = PUSH_TIMEOUT\n    req.setRequestHeader(\"content-type\", \"text/html\")\n    req.setRequestHeader(\"cache-control\", \"max-age=0, no-cache, no-store, must-revalidate, post-check=0, pre-check=0\")\n    req.setRequestHeader(LINK_HEADER, \"live-link\")\n    req.onerror = () => callback(400)\n    req.ontimeout = () => callback(504)\n    req.onreadystatechange = () => {\n      if(req.readyState !== 4){ return }\n      let requestURL = new URL(href)\n      let requestPath = requestURL.pathname + requestURL.search\n      let responseURL = maybe(req.getResponseHeader(RESPONSE_URL_HEADER) || req.responseURL, url => new URL(url))\n      let responsePath = responseURL ? responseURL.pathname + responseURL.search : null\n      if(req.getResponseHeader(LINK_HEADER) !== \"live-link\"){\n        return callback(400)\n      } else if(responseURL === null || responsePath != requestPath){\n        return callback(302)\n      } else if(req.status !== 200){\n        return callback(req.status)\n      } else {\n        callback(200, req.responseText)\n      }\n    }\n    req.send()\n  },\n\n  updateCurrentState(callback){ if(!this.canPushState()){ return }\n    history.replaceState(callback(history.state || {}), \"\", window.location.href)\n  },\n\n  pushState(kind, meta, to){\n    if(this.canPushState()){\n      if(to !== window.location.href){\n        if(meta.type == \"redirect\" && meta.scroll) {\n          // If we're redirecting store the current scrollY for the current history state.\n          let currentState = history.state || {}\n          currentState.scroll = meta.scroll\n          history.replaceState(currentState, \"\", window.location.href)\n        }\n\n        delete meta.scroll // Only store the scroll in the redirect case.\n        history[kind + \"State\"](meta, \"\", to || null) // IE will coerce undefined to string\n        let hashEl = this.getHashTargetEl(window.location.hash)\n\n        if(hashEl) {\n          hashEl.scrollIntoView()\n        } else if(meta.type === \"redirect\"){\n          window.scroll(0, 0)\n        }\n      }\n    } else {\n      this.redirect(to)\n    }\n  },\n\n  setCookie(name, value){\n    document.cookie = `${name}=${value}`\n  },\n\n  getCookie(name){\n    return document.cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${name}\\s*\\=\\s*([^;]*).*$)|^.*$`), \"$1\")\n  },\n\n  redirect(toURL, flash){\n    if(flash){ Browser.setCookie(\"__phoenix_flash__\", flash + \"; max-age=60000; path=/\") }\n    window.location = toURL\n  },\n\n  localKey(namespace, subkey){ return `${namespace}-${subkey}` },\n\n  getHashTargetEl(maybeHash) {\n    let hash = maybeHash.toString().substring(1)\n    if(hash === \"\"){ return }\n    return document.getElementById(hash) || document.querySelector(`a[name=\"${hash}\"]`)\n  }\n}\n\nexport let DOM = {\n  byId(id){ return document.getElementById(id) || logError(`no id found for ${id}`) },\n\n  removeClass(el, className){\n    el.classList.remove(className)\n    if(el.classList.length === 0){ el.removeAttribute(\"class\") }\n  },\n\n  all(node, query, callback){\n    let array = Array.from(node.querySelectorAll(query))\n    return callback ? array.forEach(callback) : array\n  },\n\n  childNodeLength(html){\n    let template = document.createElement(\"template\")\n    template.innerHTML = html\n    return template.content.childElementCount\n  },\n\n  isUploadInput(el){ return el.type === \"file\" && el.getAttribute(PHX_UPLOAD_REF) !== null },\n\n  findUploadInputs(node){ return this.all(node, `input[type=\"file\"][${PHX_UPLOAD_REF}]`) },\n\n  findComponentNodeList(node, cid){\n    return this.filterWithinSameLiveView(this.all(node, `[${PHX_COMPONENT}=\"${cid}\"]`), node)\n  },\n\n  isPhxDestroyed(node){\n    return node.id && DOM.private(node, \"destroyed\") ? true : false\n  },\n\n  markPhxChildDestroyed(el){\n    el.setAttribute(PHX_SESSION, \"\")\n    this.putPrivate(el, \"destroyed\", true)\n  },\n\n  findPhxChildrenInFragment(html, parentId){\n    let template = document.createElement(\"template\")\n    template.innerHTML = html\n    return this.findPhxChildren(template.content, parentId)\n  },\n\n  isIgnored(el, phxUpdate){\n    return (el.getAttribute(phxUpdate) || el.getAttribute(\"data-phx-update\")) === \"ignore\"\n  },\n\n  isPhxUpdate(el, phxUpdate, updateTypes){\n    return el.getAttribute && updateTypes.indexOf(el.getAttribute(phxUpdate)) >= 0\n  },\n\n  findPhxChildren(el, parentId){\n    return this.all(el, `${PHX_VIEW_SELECTOR}[${PHX_PARENT_ID}=\"${parentId}\"]`)\n  },\n\n  findParentCIDs(node, cids){\n    let initial = new Set(cids)\n    return cids.reduce((acc, cid) => {\n      let selector = `[${PHX_COMPONENT}=\"${cid}\"] [${PHX_COMPONENT}]`\n\n      this.filterWithinSameLiveView(this.all(node, selector), node)\n        .map(el => parseInt(el.getAttribute(PHX_COMPONENT)))\n        .forEach(childCID => acc.delete(childCID))\n\n      return acc\n    }, initial)\n  },\n\n  filterWithinSameLiveView(nodes, parent) {\n    if(parent.querySelector(PHX_VIEW_SELECTOR)) {\n      return nodes.filter(el => this.withinSameLiveView(el, parent))\n    } else {\n      return nodes\n    }\n  },\n\n  withinSameLiveView(node, parent){\n    while(node = node.parentNode){\n      if(node.isSameNode(parent)){ return true }\n      if(node.getAttribute(PHX_VIEW)){ return false }\n    }\n  },\n\n  private(el, key){ return el[PHX_PRIVATE] && el[PHX_PRIVATE][key] },\n\n  deletePrivate(el, key){ el[PHX_PRIVATE] && delete(el[PHX_PRIVATE][key]) },\n\n  putPrivate(el, key, value){\n    if(!el[PHX_PRIVATE]){ el[PHX_PRIVATE] = {} }\n    el[PHX_PRIVATE][key] = value\n  },\n\n  copyPrivates(target, source){\n    if(source[PHX_PRIVATE]){\n      target[PHX_PRIVATE] = clone(source[PHX_PRIVATE])\n    }\n  },\n\n  putTitle(str){\n    let titleEl = document.querySelector(\"title\")\n    let {prefix, suffix} = titleEl.dataset\n    document.title = `${prefix || \"\"}${str}${suffix || \"\"}`\n  },\n\n  debounce(el, event, phxDebounce, defaultDebounce, phxThrottle, defaultThrottle, callback){\n    let debounce = el.getAttribute(phxDebounce)\n    let throttle = el.getAttribute(phxThrottle)\n    if(debounce === \"\"){ debounce = defaultDebounce }\n    if(throttle === \"\"){ throttle = defaultThrottle }\n    let value = debounce || throttle\n    switch(value){\n      case null: return callback()\n\n      case \"blur\":\n        if(this.once(el, \"debounce-blur\")){\n          el.addEventListener(\"blur\", () => callback())\n        }\n        return\n\n      default:\n        let timeout = parseInt(value)\n        let trigger = () => throttle ? this.deletePrivate(el, THROTTLED) : callback()\n        let currentCycle = this.incCycle(el, DEBOUNCE_TRIGGER, trigger)\n        if(isNaN(timeout)){ return logError(`invalid throttle/debounce value: ${value}`) }\n        if(throttle){\n          let newKeyDown = false\n          if(event.type === \"keydown\"){\n            let prevKey = this.private(el, DEBOUNCE_PREV_KEY)\n            this.putPrivate(el, DEBOUNCE_PREV_KEY, event.key)\n            newKeyDown = prevKey !== event.key\n          }\n\n          if(!newKeyDown && this.private(el, THROTTLED)){\n            return false\n          } else {\n            callback()\n            this.putPrivate(el, THROTTLED, true)\n            setTimeout(() => this.triggerCycle(el, DEBOUNCE_TRIGGER), timeout)\n          }\n        } else {\n          setTimeout(() => this.triggerCycle(el, DEBOUNCE_TRIGGER, currentCycle), timeout)\n        }\n\n\n        let form = el.form\n        if(form && this.once(form, \"bind-debounce\")){\n          form.addEventListener(\"submit\", (e) => {\n            Array.from((new FormData(form)).entries(), ([name, val]) => {\n              let input = form.querySelector(`[name=\"${name}\"]`)\n              this.incCycle(input, DEBOUNCE_TRIGGER)\n              this.deletePrivate(input, THROTTLED)\n            })\n          })\n        }\n        if(this.once(el, \"bind-debounce\")){\n          el.addEventListener(\"blur\", (e) => this.triggerCycle(el, DEBOUNCE_TRIGGER))\n        }\n    }\n  },\n\n  triggerCycle(el, key, currentCycle){\n    let [cycle, trigger] = this.private(el, key)\n    if(!currentCycle){ currentCycle = cycle }\n    if(currentCycle === cycle){\n      this.incCycle(el, key)\n      trigger()\n    }\n  },\n\n  once(el, key){\n    if(this.private(el, key) === true){ return false }\n    this.putPrivate(el, key, true)\n    return true\n  },\n\n  incCycle(el, key, trigger = function(){}){\n    let [currentCycle, oldTrigger] = this.private(el, key) || [0, trigger]\n    currentCycle++\n    this.putPrivate(el, key, [currentCycle, trigger])\n    return currentCycle\n  },\n\n  discardError(container, el, phxFeedbackFor){\n    let field = el.getAttribute && el.getAttribute(phxFeedbackFor)\n    // TODO: Remove id lookup after we update Phoenix to use input_name instead of input_id\n    let input = field && container.querySelector(`[id=\"${field}\"], [name=\"${field}\"]`)\n    if(!input){ return }\n\n    if(!(this.private(input, PHX_HAS_FOCUSED) || this.private(input.form, PHX_HAS_SUBMITTED))){\n      el.classList.add(PHX_NO_FEEDBACK_CLASS)\n    }\n  },\n\n  showError(inputEl, phxFeedbackFor){\n    if(inputEl.id || inputEl.name){\n      this.all(inputEl.form, `[${phxFeedbackFor}=\"${inputEl.id}\"], [${phxFeedbackFor}=\"${inputEl.name}\"]`, (el) => {\n        this.removeClass(el, PHX_NO_FEEDBACK_CLASS)\n      })\n    }\n  },\n\n  isPhxChild(node){\n    return node.getAttribute && node.getAttribute(PHX_PARENT_ID)\n  },\n\n  dispatchEvent(target, eventString, detail = {}){\n    let event = new CustomEvent(eventString, {bubbles: true, cancelable: true, detail: detail})\n    target.dispatchEvent(event)\n  },\n\n  cloneNode(node, html){\n    if(typeof(html) === \"undefined\"){\n      return node.cloneNode(true)\n    } else {\n      let cloned = node.cloneNode(false)\n      cloned.innerHTML = html\n      return cloned\n    }\n  },\n\n  mergeAttrs(target, source, opts = {}){\n    let exclude = opts.exclude || []\n    let isIgnored = opts.isIgnored\n    let sourceAttrs = source.attributes\n    for (let i = sourceAttrs.length - 1; i >= 0; i--){\n      let name = sourceAttrs[i].name\n      if(exclude.indexOf(name) < 0){ target.setAttribute(name, source.getAttribute(name)) }\n    }\n\n    let targetAttrs = target.attributes\n    for (let i = targetAttrs.length - 1; i >= 0; i--){\n      let name = targetAttrs[i].name\n      if(isIgnored){\n        if(name.startsWith(\"data-\") && !source.hasAttribute(name)){ target.removeAttribute(name) }\n      } else {\n        if(!source.hasAttribute(name)){ target.removeAttribute(name) }\n      }\n    }\n  },\n\n  mergeFocusedInput(target, source){\n    // skip selects because FF will reset highlighted index for any setAttribute\n    if(!(target instanceof HTMLSelectElement)){ DOM.mergeAttrs(target, source, {except: [\"value\"]}) }\n    if(source.readOnly){\n      target.setAttribute(\"readonly\", true)\n    } else {\n      target.removeAttribute(\"readonly\")\n    }\n  },\n\n  hasSelectionRange(el) {\n    return el.setSelectionRange && (el.type === \"text\" || el.type === \"textarea\")\n  },\n\n  restoreFocus(focused, selectionStart, selectionEnd){\n    if(!DOM.isTextualInput(focused)){ return }\n    let wasFocused = focused.matches(\":focus\")\n    if(focused.readOnly){ focused.blur() }\n    if(!wasFocused){ focused.focus() }\n    if(this.hasSelectionRange(focused)){\n      focused.setSelectionRange(selectionStart, selectionEnd)\n    }\n  },\n\n  isFormInput(el){ return /^(?:input|select|textarea)$/i.test(el.tagName) && el.type !== \"button\"},\n\n  syncAttrsToProps(el){\n    if(el instanceof HTMLInputElement && CHECKABLE_INPUTS.indexOf(el.type.toLocaleLowerCase()) >= 0){\n      el.checked = el.getAttribute(\"checked\") !== null\n    }\n  },\n\n  isTextualInput(el){ return FOCUSABLE_INPUTS.indexOf(el.type) >= 0 },\n\n  isNowTriggerFormExternal(el, phxTriggerExternal){\n    return el.getAttribute && el.getAttribute(phxTriggerExternal) !== null\n  },\n\n  syncPendingRef(fromEl, toEl, disableWith){\n    let ref = fromEl.getAttribute(PHX_REF)\n    if(ref === null){ return true }\n\n    if(DOM.isFormInput(fromEl) || fromEl.getAttribute(disableWith) !== null){\n      if(DOM.isUploadInput(fromEl)){ DOM.mergeAttrs(fromEl, toEl, {isIgnored: true}) }\n      DOM.putPrivate(fromEl, PHX_REF, toEl)\n      return false\n    } else {\n      PHX_EVENT_CLASSES.forEach(className => {\n        fromEl.classList.contains(className) && toEl.classList.add(className)\n      })\n      toEl.setAttribute(PHX_REF, ref)\n      return true\n    }\n  },\n\n  cleanChildNodes(container, phxUpdate){\n    if (DOM.isPhxUpdate(container, phxUpdate, [\"append\", \"prepend\"])) {\n      let toRemove = []\n      container.childNodes.forEach(childNode => {\n        if(!childNode.id){\n          // Skip warning if it's an empty text node (e.g. a new-line)\n          let isEmptyTextNode = childNode.nodeType === Node.TEXT_NODE && childNode.nodeValue.trim() === \"\"\n          if(!isEmptyTextNode){\n            logError(`only HTML element tags with an id are allowed inside containers with phx-update.\\n\\n` +\n                    `removing illegal node: \"${(childNode.outerHTML || childNode.nodeValue).trim()}\"\\n\\n`)\n          }\n          toRemove.push(childNode)\n        }\n      })\n      toRemove.forEach(childNode => childNode.remove())\n    }\n  }\n}\n\nclass DOMPostMorphRestorer {\n  constructor(containerBefore, containerAfter, updateType) {\n    let idsBefore = new Set()\n    let idsAfter = new Set([...containerAfter.children].map(child => child.id))\n\n    let elementsToModify = []\n\n    Array.from(containerBefore.children).forEach(child => {\n      if (child.id) { // all of our children should be elements with ids\n        idsBefore.add(child.id)\n        if (idsAfter.has(child.id)) {\n          let previousElementId = child.previousElementSibling && child.previousElementSibling.id\n          elementsToModify.push({elementId: child.id, previousElementId: previousElementId})\n        }\n      }\n    })\n\n    this.containerId = containerAfter.id\n    this.updateType = updateType\n    this.elementsToModify = elementsToModify\n    this.elementIdsToAdd = [...idsAfter].filter(id => !idsBefore.has(id))\n  }\n\n  // We do the following to optimize append/prepend operations:\n  //   1) Track ids of modified elements & of new elements\n  //   2) All the modified elements are put back in the correct position in the DOM tree\n  //      by storing the id of their previous sibling\n  //   3) New elements are going to be put in the right place by morphdom during append.\n  //      For prepend, we move them to the first position in the container\n  perform() {\n    let container = DOM.byId(this.containerId)\n    this.elementsToModify.forEach(elementToModify => {\n      if (elementToModify.previousElementId) {\n        maybe(document.getElementById(elementToModify.previousElementId), previousElem => {\n          maybe(document.getElementById(elementToModify.elementId), elem => {\n            let isInRightPlace = elem.previousElementSibling && elem.previousElementSibling.id == previousElem.id\n            if (!isInRightPlace) {\n              previousElem.insertAdjacentElement(\"afterend\", elem)\n            }\n          })\n        })\n      } else {\n        // This is the first element in the container\n        maybe(document.getElementById(elementToModify.elementId), elem => {\n          let isInRightPlace = elem.previousElementSibling == null\n          if (!isInRightPlace) {\n            container.insertAdjacentElement(\"afterbegin\", elem)\n          }\n        })\n      }\n    })\n\n    if(this.updateType == \"prepend\"){\n      this.elementIdsToAdd.reverse().forEach(elemId => {\n        maybe(document.getElementById(elemId), elem => container.insertAdjacentElement(\"afterbegin\", elem))\n      })\n    }\n  }\n}\n\nclass DOMPatch {\n  static patchEl(fromEl, toEl, activeElement){\n    morphdom(fromEl, toEl, {\n      childrenOnly: false,\n      onBeforeElUpdated: (fromEl, toEl) => {\n        if(activeElement && activeElement.isSameNode(fromEl) && DOM.isFormInput(fromEl)){\n          DOM.mergeFocusedInput(fromEl, toEl)\n          return false\n        }\n      }\n    })\n  }\n\n  constructor(view, container, id, html, targetCID){\n    this.view = view\n    this.liveSocket = view.liveSocket\n    this.container = container\n    this.id = id\n    this.rootID = view.root.id\n    this.html = html\n    this.targetCID = targetCID\n    this.cidPatch = typeof(this.targetCID) === \"number\"\n    this.callbacks = {\n      beforeadded: [], beforeupdated: [], beforephxChildAdded: [],\n      afteradded: [], afterupdated: [], afterdiscarded: [], afterphxChildAdded: []\n    }\n  }\n\n  before(kind, callback){ this.callbacks[`before${kind}`].push(callback) }\n  after(kind, callback){ this.callbacks[`after${kind}`].push(callback) }\n\n  trackBefore(kind, ...args){\n    this.callbacks[`before${kind}`].forEach(callback => callback(...args))\n  }\n\n  trackAfter(kind, ...args){\n    this.callbacks[`after${kind}`].forEach(callback => callback(...args))\n  }\n\n  markPrunableContentForRemoval(){\n    DOM.all(this.container, `[phx-update=append] > *, [phx-update=prepend] > *`, el => {\n      el.setAttribute(PHX_REMOVE, \"\")\n    })\n  }\n\n  perform(){\n    let {view, liveSocket, container, html} = this\n    let targetContainer = this.isCIDPatch() ? this.targetCIDContainer(html) : container\n    if(this.isCIDPatch() && !targetContainer){ return }\n\n    let focused = liveSocket.getActiveElement()\n    let {selectionStart, selectionEnd} = focused && DOM.hasSelectionRange(focused) ? focused : {}\n    let phxUpdate = liveSocket.binding(PHX_UPDATE)\n    let phxFeedbackFor = liveSocket.binding(PHX_FEEDBACK_FOR)\n    let disableWith = liveSocket.binding(PHX_DISABLE_WITH)\n    let phxTriggerExternal = liveSocket.binding(PHX_TRIGGER_ACTION)\n    let added = []\n    let updates = []\n    let appendPrependUpdates = []\n    let externalFormTriggered = null\n\n    let diffHTML = liveSocket.time(\"premorph container prep\", () => {\n      return this.buildDiffHTML(container, html, phxUpdate, targetContainer)\n    })\n\n    this.trackBefore(\"added\", container)\n    this.trackBefore(\"updated\", container, container)\n\n    liveSocket.time(\"morphdom\", () => {\n      morphdom(targetContainer, diffHTML, {\n        childrenOnly: targetContainer.getAttribute(PHX_COMPONENT) === null,\n        getNodeKey: (node) => {\n          return DOM.isPhxDestroyed(node) ? null : node.id\n        },\n        onBeforeNodeAdded: (el) => {\n          //input handling\n          DOM.discardError(targetContainer, el, phxFeedbackFor)\n          this.trackBefore(\"added\", el)\n          return el\n        },\n        onNodeAdded: (el) => {\n          if(DOM.isNowTriggerFormExternal(el, phxTriggerExternal)){\n            externalFormTriggered = el\n          }\n          // nested view handling\n          if(DOM.isPhxChild(el) && view.ownsElement(el)){\n            this.trackAfter(\"phxChildAdded\", el)\n          }\n          added.push(el)\n        },\n        onNodeDiscarded: (el) => {\n          // nested view handling\n          if(DOM.isPhxChild(el)){ liveSocket.destroyViewByEl(el) }\n          this.trackAfter(\"discarded\", el)\n        },\n        onBeforeNodeDiscarded: (el) => {\n          if(el.getAttribute && el.getAttribute(PHX_REMOVE) !== null){ return true }\n          if(el.parentNode !== null && DOM.isPhxUpdate(el.parentNode, phxUpdate, [\"append\", \"prepend\"]) && el.id){ return false }\n          if(this.skipCIDSibling(el)){ return false }\n          return true\n        },\n        onElUpdated: (el) => {\n          if(DOM.isNowTriggerFormExternal(el, phxTriggerExternal)){\n            externalFormTriggered = el\n          }\n          updates.push(el)\n        },\n        onBeforeElUpdated: (fromEl, toEl) => {\n          DOM.cleanChildNodes(toEl, phxUpdate)\n          if(this.skipCIDSibling(toEl)){ return false }\n          if(DOM.isIgnored(fromEl, phxUpdate)){\n            this.trackBefore(\"updated\", fromEl, toEl)\n            DOM.mergeAttrs(fromEl, toEl, {isIgnored: true})\n            updates.push(fromEl)\n            return false\n          }\n          if(fromEl.type === \"number\" && (fromEl.validity && fromEl.validity.badInput)){ return false }\n          if(!DOM.syncPendingRef(fromEl, toEl, disableWith)){\n            if(DOM.isUploadInput(fromEl)){\n              this.trackBefore(\"updated\", fromEl, toEl)\n              updates.push(fromEl)\n            }\n            return false\n          }\n\n          // nested view handling\n          if(DOM.isPhxChild(toEl)){\n            let prevSession = fromEl.getAttribute(PHX_SESSION)\n            DOM.mergeAttrs(fromEl, toEl, {exclude: [PHX_STATIC]})\n            if(prevSession !== \"\"){ fromEl.setAttribute(PHX_SESSION, prevSession) }\n            fromEl.setAttribute(PHX_ROOT_ID, this.rootID)\n            return false\n          }\n\n          // input handling\n          DOM.copyPrivates(toEl, fromEl)\n          DOM.discardError(targetContainer, toEl, phxFeedbackFor)\n\n          let isFocusedFormEl = focused && fromEl.isSameNode(focused) && DOM.isFormInput(fromEl)\n          if(isFocusedFormEl && !this.forceFocusedSelectUpdate(fromEl, toEl)){\n            this.trackBefore(\"updated\", fromEl, toEl)\n            DOM.mergeFocusedInput(fromEl, toEl)\n            DOM.syncAttrsToProps(fromEl)\n            updates.push(fromEl)\n            return false\n          } else {\n            if(DOM.isPhxUpdate(toEl, phxUpdate, [\"append\", \"prepend\"])){\n              appendPrependUpdates.push(new DOMPostMorphRestorer(fromEl, toEl, toEl.getAttribute(phxUpdate)))\n            }\n            DOM.syncAttrsToProps(toEl)\n            this.trackBefore(\"updated\", fromEl, toEl)\n            return true\n          }\n        }\n      })\n    })\n\n    if(liveSocket.isDebugEnabled()){ detectDuplicateIds() }\n\n    if(appendPrependUpdates.length > 0){\n      liveSocket.time(\"post-morph append/prepend restoration\", () => {\n        appendPrependUpdates.forEach(update => update.perform())\n      })\n    }\n\n    liveSocket.silenceEvents(() => DOM.restoreFocus(focused, selectionStart, selectionEnd))\n    DOM.dispatchEvent(document, \"phx:update\")\n    added.forEach(el => this.trackAfter(\"added\", el))\n    updates.forEach(el => this.trackAfter(\"updated\", el))\n\n    if(externalFormTriggered){\n      liveSocket.disconnect()\n      externalFormTriggered.submit()\n    }\n    return true\n  }\n\n  forceFocusedSelectUpdate(fromEl, toEl){\n    let isSelect = [\"select\", \"select-one\", \"select-multiple\"].find((t) => t === fromEl.type)\n    return fromEl.multiple === true || (isSelect && fromEl.innerHTML != toEl.innerHTML)\n  }\n\n  isCIDPatch(){ return this.cidPatch }\n\n  skipCIDSibling(el){\n    return el.nodeType === Node.ELEMENT_NODE && el.getAttribute(PHX_SKIP) !== null\n  }\n\n  targetCIDContainer(html){ if(!this.isCIDPatch()){ return }\n    let [first, ...rest] = DOM.findComponentNodeList(this.container, this.targetCID)\n    if(rest.length === 0 && DOM.childNodeLength(html) === 1){\n      return first\n    } else {\n      return first && first.parentNode\n    }\n  }\n\n  // builds HTML for morphdom patch\n  // - for full patches of LiveView or a component with a single\n  //   root node, simply returns the HTML\n  // - for patches of a component with multiple root nodes, the\n  //   parent node becomes the target container and non-component\n  //   siblings are marked as skip.\n  buildDiffHTML(container, html, phxUpdate, targetContainer){\n    let isCIDPatch = this.isCIDPatch()\n    let isCIDWithSingleRoot = isCIDPatch && targetContainer.getAttribute(PHX_COMPONENT) === this.targetCID.toString()\n    if(!isCIDPatch || isCIDWithSingleRoot){\n      return html\n    } else {\n      // component patch with multiple CID roots\n      let diffContainer = null\n      let template = document.createElement(\"template\")\n      diffContainer = DOM.cloneNode(targetContainer)\n      let [firstComponent, ...rest] = DOM.findComponentNodeList(diffContainer, this.targetCID)\n      template.innerHTML = html\n      rest.forEach(el => el.remove())\n      Array.from(diffContainer.childNodes).forEach(child => {\n        // we can only skip trackable nodes with an ID\n        if(child.id && child.nodeType === Node.ELEMENT_NODE && child.getAttribute(PHX_COMPONENT) !== this.targetCID.toString()){\n          child.setAttribute(PHX_SKIP, \"\")\n          child.innerHTML = \"\"\n        }\n      })\n      Array.from(template.content.childNodes).forEach(el => diffContainer.insertBefore(el, firstComponent))\n      firstComponent.remove()\n      return diffContainer.outerHTML\n    }\n  }\n}\n\nexport class View {\n  constructor(el, liveSocket, parentView, href, flash){\n    this.liveSocket = liveSocket\n    this.flash = flash\n    this.parent = parentView\n    this.root = parentView ? parentView.root : this\n    this.el = el\n    this.id = this.el.id\n    this.view = this.el.getAttribute(PHX_VIEW)\n    this.ref = 0\n    this.childJoins = 0\n    this.loaderTimer = null\n    this.pendingDiffs = []\n    this.pruningCIDs = []\n    this.href = href\n    this.joinCount = this.parent ? this.parent.joinCount - 1 : 0\n    this.joinPending = true\n    this.destroyed = false\n    this.joinCallback = function(){}\n    this.stopCallback = function(){}\n    this.pendingJoinOps = this.parent ? null : []\n    this.viewHooks = {}\n    this.uploaders = {}\n    this.formSubmits = []\n    this.children = this.parent ? null : {}\n    this.root.children[this.id] = {}\n    this.channel = this.liveSocket.channel(`lv:${this.id}`, () => {\n      return {\n        url: this.href,\n        params: this.connectParams(),\n        session: this.getSession(),\n        static: this.getStatic(),\n        flash: this.flash\n      }\n    })\n    this.showLoader(this.liveSocket.loaderTimeout)\n    this.bindChannel()\n  }\n\n  isMain(){ return this.liveSocket.main === this }\n\n  connectParams(){\n    let params = this.liveSocket.params(this.view)\n    let manifest =\n      DOM.all(document, `[${this.binding(PHX_TRACK_STATIC)}]`)\n      .map(node => node.src || node.href).filter(url => typeof(url) === \"string\")\n\n    if(manifest.length > 0){ params[\"_track_static\"] = manifest }\n    params[\"_mounts\"] = this.joinCount\n\n    return params\n  }\n\n  name(){ return this.view }\n\n  isConnected(){ return this.channel.canPush() }\n\n  getSession(){ return this.el.getAttribute(PHX_SESSION) }\n\n  getStatic(){\n    let val = this.el.getAttribute(PHX_STATIC)\n    return val === \"\" ? null : val\n  }\n\n  destroy(callback = function(){}){\n    this.destroyAllChildren()\n    this.destroyed = true\n    delete this.root.children[this.id]\n    if(this.parent){ delete this.root.children[this.parent.id][this.id] }\n    clearTimeout(this.loaderTimer)\n    let onFinished = () => {\n      callback()\n      for(let id in this.viewHooks){\n        this.destroyHook(this.viewHooks[id])\n      }\n    }\n\n    DOM.markPhxChildDestroyed(this.el)\n\n    this.log(\"destroyed\", () => [\"the child has been removed from the parent\"])\n    this.channel.leave()\n      .receive(\"ok\", onFinished)\n      .receive(\"error\", onFinished)\n      .receive(\"timeout\", onFinished)\n  }\n\n  setContainerClasses(...classes){\n    this.el.classList.remove(\n      PHX_CONNECTED_CLASS,\n      PHX_DISCONNECTED_CLASS,\n      PHX_ERROR_CLASS\n    )\n    this.el.classList.add(...classes)\n  }\n\n  isLoading(){ return this.el.classList.contains(PHX_DISCONNECTED_CLASS)}\n\n  showLoader(timeout){\n    clearTimeout(this.loaderTimer)\n    if(timeout){\n      this.loaderTimer = setTimeout(() => this.showLoader(), timeout)\n    } else {\n      for(let id in this.viewHooks){ this.viewHooks[id].__disconnected() }\n      this.setContainerClasses(PHX_DISCONNECTED_CLASS)\n    }\n  }\n\n  hideLoader(){\n    clearTimeout(this.loaderTimer)\n    this.setContainerClasses(PHX_CONNECTED_CLASS)\n  }\n\n  triggerReconnected(){\n    for(let id in this.viewHooks){ this.viewHooks[id].__reconnected() }\n  }\n\n  log(kind, msgCallback){\n    this.liveSocket.log(this, kind, msgCallback)\n  }\n\n  withinTargets(phxTarget, callback){\n    if(phxTarget instanceof HTMLElement) {\n      return this.liveSocket.owner(phxTarget, view => callback(view, phxTarget))\n    }\n\n    if(/^(0|[1-9]\\d*)$/.test(phxTarget)){\n      let targets = DOM.findComponentNodeList(this.el, phxTarget)\n      if(targets.length === 0){\n        logError(`no component found matching phx-target of ${phxTarget}`)\n      } else {\n        callback(this, targets[0])\n      }\n    } else {\n      let targets = Array.from(document.querySelectorAll(phxTarget))\n      if(targets.length === 0){ logError(`nothing found matching the phx-target selector \"${phxTarget}\"`) }\n      targets.forEach(target => this.liveSocket.owner(target, view => callback(view, target)))\n    }\n  }\n\n  applyDiff(type, rawDiff, callback){\n    this.log(type, () => [\"\", clone(rawDiff)])\n    let {diff, reply, events, title} = Rendered.extract(rawDiff)\n    if(title){ DOM.putTitle(title) }\n\n    callback({diff, reply, events})\n    return reply\n  }\n\n  onJoin(resp){\n    let {rendered} = resp\n    this.childJoins = 0\n    this.joinPending = true\n    this.flash = null\n\n    Browser.dropLocal(this.liveSocket.localStorage, this.name(), CONSECUTIVE_RELOADS)\n    this.applyDiff(\"mount\", rendered, ({diff, events}) => {\n      this.rendered = new Rendered(this.id, diff)\n      let html = this.renderContainer(null, \"join\")\n      this.dropPendingRefs()\n      let forms = this.formsForRecovery(html)\n      this.joinCount++\n\n      if(forms.length > 0){\n        forms.forEach((form, i) => {\n          this.pushFormRecovery(form, resp => {\n            if(i === forms.length - 1){\n              this.onJoinComplete(resp, html, events)\n            }\n          })\n        })\n      } else {\n        this.onJoinComplete(resp, html, events)\n      }\n    })\n  }\n\n  dropPendingRefs(){ DOM.all(this.el, `[${PHX_REF}]`, el => el.removeAttribute(PHX_REF)) }\n\n  onJoinComplete({live_patch}, html, events){\n    // In order to provide a better experience, we want to join\n    // all LiveViews first and only then apply their patches.\n    if(this.joinCount > 1 || (this.parent && !this.parent.isJoinPending())){\n      return this.applyJoinPatch(live_patch, html, events)\n    }\n\n    // One downside of this approach is that we need to find phxChildren\n    // in the html fragment, instead of directly on the DOM. The fragment\n    // also does not include PHX_STATIC, so we need to copy it over from\n    // the DOM.\n    let newChildren = DOM.findPhxChildrenInFragment(html, this.id).filter(toEl => {\n      let fromEl = toEl.id && this.el.querySelector(`#${toEl.id}`)\n      let phxStatic = fromEl && fromEl.getAttribute(PHX_STATIC)\n      if(phxStatic){ toEl.setAttribute(PHX_STATIC, phxStatic) }\n      return this.joinChild(toEl)\n    })\n\n    if(newChildren.length === 0){\n      if(this.parent){\n        this.root.pendingJoinOps.push([this, () => this.applyJoinPatch(live_patch, html, events)])\n        this.parent.ackJoin(this)\n      } else {\n        this.onAllChildJoinsComplete()\n        this.applyJoinPatch(live_patch, html, events)\n      }\n    } else {\n      this.root.pendingJoinOps.push([this, () => this.applyJoinPatch(live_patch, html, events)])\n    }\n  }\n\n  attachTrueDocEl(){\n    this.el = DOM.byId(this.id)\n    this.el.setAttribute(PHX_ROOT_ID, this.root.id)\n  }\n\n  dispatchEvents(events){\n    events.forEach(([event, payload]) => {\n      window.dispatchEvent(new CustomEvent(`phx:hook:${event}`, {detail: payload}))\n    })\n  }\n\n  applyJoinPatch(live_patch, html, events){\n    this.attachTrueDocEl()\n    let patch = new DOMPatch(this, this.el, this.id, html, null)\n    patch.markPrunableContentForRemoval()\n    this.performPatch(patch, false)\n    this.joinNewChildren()\n    DOM.all(this.el, `[${this.binding(PHX_HOOK)}], [data-phx-${PHX_HOOK}]`, hookEl => {\n      let hook = this.addHook(hookEl)\n      if(hook){ hook.__mounted() }\n    })\n\n    this.joinPending = false\n    this.dispatchEvents(events)\n    this.applyPendingUpdates()\n\n    if(live_patch){\n      let {kind, to} = live_patch\n      this.liveSocket.historyPatch(to, kind)\n    }\n    this.hideLoader()\n    if(this.joinCount > 1){ this.triggerReconnected() }\n    this.stopCallback()\n  }\n\n  triggerBeforeUpdateHook(fromEl, toEl){\n    this.liveSocket.triggerDOM(\"onBeforeElUpdated\", [fromEl, toEl])\n    let hook = this.getHook(fromEl)\n    let isIgnored = hook && DOM.isIgnored(fromEl, this.binding(PHX_UPDATE))\n    if(hook && !fromEl.isEqualNode(toEl) && !(isIgnored && isEqualObj(fromEl.dataset, toEl.dataset))){\n      hook.__beforeUpdate()\n      return hook\n    }\n  }\n\n  performPatch(patch, pruneCids){\n    let destroyedCIDs = []\n    let phxChildrenAdded = false\n    let updatedHookIds = new Set()\n\n    patch.after(\"added\", el => {\n      this.liveSocket.triggerDOM(\"onNodeAdded\", [el])\n\n      let newHook = this.addHook(el)\n      if(newHook){ newHook.__mounted() }\n    })\n\n    patch.after(\"phxChildAdded\", el => phxChildrenAdded = true)\n\n    patch.before(\"updated\", (fromEl, toEl) => {\n      let hook = this.triggerBeforeUpdateHook(fromEl, toEl)\n      if(hook){ updatedHookIds.add(fromEl.id) }\n    })\n\n    patch.after(\"updated\", el => {\n      if(updatedHookIds.has(el.id)){ this.getHook(el).__updated() }\n    })\n\n    patch.after(\"discarded\", (el) => {\n      let cid = this.componentID(el)\n      if(typeof(cid) === \"number\" && destroyedCIDs.indexOf(cid) === -1){ destroyedCIDs.push(cid) }\n      let hook = this.getHook(el)\n      hook && this.destroyHook(hook)\n    })\n\n    patch.perform()\n\n    // We should not pruneCids on joins. Otherwise, in case of\n    // rejoins, we may notify cids that no longer belong to the\n    // current LiveView to be removed.\n    if(pruneCids) {\n      this.maybePushComponentsDestroyed(destroyedCIDs)\n    }\n\n    return phxChildrenAdded\n  }\n\n  joinNewChildren(){\n    DOM.findPhxChildren(this.el, this.id).forEach(el => this.joinChild(el))\n  }\n\n  getChildById(id){ return this.root.children[this.id][id] }\n\n  getDescendentByEl(el){\n    if(el.id === this.id){\n      return this\n    } else {\n      return this.children[el.getAttribute(PHX_PARENT_ID)][el.id]\n    }\n  }\n\n  destroyDescendent(id){\n    for(let parentId in this.root.children){\n      for(let childId in this.root.children[parentId]){\n        if(childId === id){ return this.root.children[parentId][childId].destroy() }\n      }\n    }\n  }\n\n  joinChild(el){\n    let child = this.getChildById(el.id)\n    if(!child){\n      let view = new View(el, this.liveSocket, this)\n      this.root.children[this.id][view.id] = view\n      view.join()\n      this.childJoins++\n      return true\n    }\n  }\n\n  isJoinPending(){ return this.joinPending }\n\n  ackJoin(child){\n    this.childJoins--\n\n    if(this.childJoins === 0){\n      if(this.parent){\n        this.parent.ackJoin(this)\n      } else {\n        this.onAllChildJoinsComplete()\n      }\n    }\n  }\n\n  onAllChildJoinsComplete(){\n    this.joinCallback()\n    this.pendingJoinOps.forEach(([view, op]) => {\n      if(!view.isDestroyed()){ op() }\n    })\n    this.pendingJoinOps = []\n  }\n\n  update(diff, events){\n    if(this.isJoinPending() || this.liveSocket.hasPendingLink()){\n      return this.pendingDiffs.push({diff, events})\n    }\n\n    this.rendered.mergeDiff(diff)\n    let phxChildrenAdded = false\n\n    // When the diff only contains component diffs, then walk components\n    // and patch only the parent component containers found in the diff.\n    // Otherwise, patch entire LV container.\n    if(this.rendered.isComponentOnlyDiff(diff)){\n      this.liveSocket.time(\"component patch complete\", () => {\n        let parentCids = DOM.findParentCIDs(this.el, this.rendered.componentCIDs(diff))\n        parentCids.forEach(parentCID => {\n          if(this.componentPatch(this.rendered.getComponent(diff, parentCID), parentCID)){ phxChildrenAdded = true }\n        })\n      })\n    } else if(!isEmpty(diff)){\n      this.liveSocket.time(\"full patch complete\", () => {\n        let html = this.renderContainer(diff, \"update\")\n        let patch = new DOMPatch(this, this.el, this.id, html, null)\n        phxChildrenAdded = this.performPatch(patch, true)\n      })\n    }\n\n    this.dispatchEvents(events)\n    if(phxChildrenAdded){ this.joinNewChildren() }\n  }\n\n  renderContainer(diff, kind){\n    return this.liveSocket.time(`toString diff (${kind})`, () => {\n      let tag = this.el.tagName\n      // Don't skip any component in the diff nor any marked as pruned\n      // (as they may have been added back)\n      let cids = diff ? this.rendered.componentCIDs(diff).concat(this.pruningCIDs) : null\n      let html = this.rendered.toString(cids)\n      return `<${tag}>${html}</${tag}>`\n    })\n  }\n\n  componentPatch(diff, cid){\n    if(isEmpty(diff)) return false\n    let html = this.rendered.componentToString(cid)\n    let patch = new DOMPatch(this, this.el, this.id, html, cid)\n    let childrenAdded = this.performPatch(patch, true)\n    return childrenAdded\n  }\n\n  getHook(el){ return this.viewHooks[ViewHook.elementID(el)] }\n\n  addHook(el){ if(ViewHook.elementID(el) || !el.getAttribute){ return }\n    let hookName = el.getAttribute(`data-phx-${PHX_HOOK}`) || el.getAttribute(this.binding(PHX_HOOK))\n    if(hookName && !this.ownsElement(el)){ return }\n    let callbacks = this.liveSocket.getHookCallbacks(hookName)\n\n    if(callbacks){\n      if(!el.id){ logError(`no DOM ID for hook \"${hookName}\". Hooks require a unique ID on each element.`, el)}\n      let hook = new ViewHook(this, el, callbacks)\n      this.viewHooks[ViewHook.elementID(hook.el)] = hook\n      return hook\n    } else if(hookName !== null){\n      logError(`unknown hook found for \"${hookName}\"`, el)\n    }\n  }\n\n  destroyHook(hook){\n    hook.__destroyed()\n    hook.__cleanup__()\n    delete this.viewHooks[ViewHook.elementID(hook.el)]\n  }\n\n  applyPendingUpdates(){\n    this.pendingDiffs.forEach(({diff, events}) => this.update(diff, events))\n    this.pendingDiffs = []\n  }\n\n  onChannel(event, cb){\n    this.liveSocket.onChannel(this.channel, event, resp => {\n      if(this.isJoinPending()){\n        this.root.pendingJoinOps.push([this, () => cb(resp)])\n      } else {\n        cb(resp)\n      }\n    })\n  }\n\n  bindChannel(){\n    // The diff event should be handled by the regular update operations.\n    // All other operations are queued to be applied only after join.\n    this.liveSocket.onChannel(this.channel, \"diff\", (rawDiff) => {\n      this.applyDiff(\"update\", rawDiff, ({diff, events}) => this.update(diff, events))\n    })\n    this.onChannel(\"redirect\", ({to, flash}) => this.onRedirect({to, flash}))\n    this.onChannel(\"live_patch\", (redir) => this.onLivePatch(redir))\n    this.onChannel(\"live_redirect\", (redir) => this.onLiveRedirect(redir))\n    this.channel.onError(reason => {\n      console.trace()\n      this.onError(reason)\n    })\n    this.channel.onClose(reason => this.onClose(reason))\n  }\n\n  destroyAllChildren(){\n    for(let id in this.root.children[this.id]){\n      this.getChildById(id).destroy()\n    }\n  }\n\n  onLiveRedirect(redir){\n    let {to, kind, flash} = redir\n    let url = this.expandURL(to)\n    this.liveSocket.historyRedirect(url, kind, flash)\n  }\n\n  onLivePatch(redir){\n    let {to, kind} = redir\n    this.href = this.expandURL(to)\n    this.liveSocket.historyPatch(to, kind)\n  }\n\n  expandURL(to){\n    return to.startsWith(\"/\") ? `${window.location.protocol}//${window.location.host}${to}` : to\n  }\n\n  onRedirect({to, flash}){ this.liveSocket.redirect(to, flash) }\n\n  isDestroyed(){ return this.destroyed }\n\n  join(callback){\n    if(!this.parent){\n      this.stopCallback = this.liveSocket.withPageLoading({to: this.href, kind: \"initial\"})\n    }\n    this.joinCallback = () => callback && callback(this, this.joinCount)\n    this.liveSocket.wrapPush(this, {timeout: false}, () => {\n      return this.channel.join()\n        .receive(\"ok\", data => this.onJoin(data))\n        .receive(\"error\", resp => this.onJoinError(resp))\n        .receive(\"timeout\", () => this.onJoinError({reason: \"timeout\"}))\n    })\n  }\n\n  onJoinError(resp){\n    if(resp.redirect || resp.live_redirect){\n      this.joinPending = false\n      this.channel.leave()\n    }\n    if(resp.redirect){ return this.onRedirect(resp.redirect) }\n    if(resp.live_redirect){ return this.onLiveRedirect(resp.live_redirect) }\n    this.log(\"error\", () => [\"unable to join\", resp])\n    return this.liveSocket.reloadWithJitter(this)\n  }\n\n  onClose(reason){\n    if(this.isDestroyed()){ return }\n    if((this.isJoinPending() && document.visibilityState !== \"hidden\") ||\n       (this.liveSocket.hasPendingLink() && reason !== \"leave\")){\n\n      return this.liveSocket.reloadWithJitter(this)\n    }\n    this.destroyAllChildren()\n    this.liveSocket.dropActiveElement(this)\n    // document.activeElement can be null in Internet Explorer 11\n    if(document.activeElement){ document.activeElement.blur() }\n    if(this.liveSocket.isUnloaded()){\n      this.showLoader(BEFORE_UNLOAD_LOADER_TIMEOUT)\n    }\n  }\n\n  onError(reason){\n    console.trace()\n    this.onClose(reason)\n    this.log(\"error\", () => [\"view crashed\", reason])\n    if(!this.liveSocket.isUnloaded()){ this.displayError() }\n  }\n\n  displayError(){\n    if(this.isMain()){ DOM.dispatchEvent(window, \"phx:page-loading-start\", {to: this.href, kind: \"error\"}) }\n    this.showLoader()\n    this.setContainerClasses(PHX_DISCONNECTED_CLASS, PHX_ERROR_CLASS)\n  }\n\n  pushWithReply(refGenerator, event, payload, onReply = function(){}){\n    if(!this.isConnected()){ return }\n\n    let [ref, [el]] = refGenerator ? refGenerator() : [null, []]\n    let onLoadingDone = function(){}\n    if(el && (el.getAttribute(this.binding(PHX_PAGE_LOADING)) !== null)){\n      onLoadingDone = this.liveSocket.withPageLoading({kind: \"element\", target: el})\n    }\n\n    if(typeof(payload.cid) !== \"number\"){ delete payload.cid }\n    return(\n      this.liveSocket.wrapPush(this, {timeout: true}, () => {\n        return this.channel.push(event, payload, PUSH_TIMEOUT).receive(\"ok\", resp => {\n          let hookReply = null\n          if(ref !== null){ this.undoRefs(ref) }\n          if(resp.diff){\n            hookReply = this.applyDiff(\"update\", resp.diff, ({diff, events}) => {\n              this.update(diff, events)\n            })\n          }\n          if(resp.redirect){ this.onRedirect(resp.redirect) }\n          if(resp.live_patch){ this.onLivePatch(resp.live_patch) }\n          if(resp.live_redirect){ this.onLiveRedirect(resp.live_redirect) }\n          onLoadingDone()\n          onReply(resp, hookReply)\n        })\n      })\n    )\n  }\n\n  undoRefs(ref){\n    DOM.all(this.el, `[${PHX_REF}=\"${ref}\"]`, el => {\n      // remove refs\n      el.removeAttribute(PHX_REF)\n      // restore inputs\n      if(el.getAttribute(PHX_READONLY) !== null){\n        el.readOnly = false\n        el.removeAttribute(PHX_READONLY)\n      }\n      if(el.getAttribute(PHX_DISABLED) !== null){\n        el.disabled = false\n        el.removeAttribute(PHX_DISABLED)\n      }\n      // remove classes\n      PHX_EVENT_CLASSES.forEach(className => DOM.removeClass(el, className))\n      // restore disables\n      let disableRestore = el.getAttribute(PHX_DISABLE_WITH_RESTORE)\n      if(disableRestore !== null){\n        el.innerText = disableRestore\n        el.removeAttribute(PHX_DISABLE_WITH_RESTORE)\n      }\n      let toEl = DOM.private(el, PHX_REF)\n      if(toEl){\n        let hook = this.triggerBeforeUpdateHook(el, toEl)\n        DOMPatch.patchEl(el, toEl, this.liveSocket.getActiveElement())\n        if(hook){ hook.__updated() }\n        DOM.deletePrivate(el, PHX_REF)\n      }\n    })\n  }\n\n  putRef(elements, event){\n    let newRef = this.ref++\n    let disableWith = this.binding(PHX_DISABLE_WITH)\n\n    elements.forEach(el => {\n      el.classList.add(`phx-${event}-loading`)\n      el.setAttribute(PHX_REF, newRef)\n      let disableText = el.getAttribute(disableWith)\n      if(disableText !== null){\n        if(!el.getAttribute(PHX_DISABLE_WITH_RESTORE)){\n          el.setAttribute(PHX_DISABLE_WITH_RESTORE, el.innerText)\n        }\n        el.innerText = disableText\n      }\n    })\n    return [newRef, elements]\n  }\n\n  componentID(el){\n    let cid = el.getAttribute && el.getAttribute(PHX_COMPONENT)\n    return cid ? parseInt(cid) : null\n  }\n\n  targetComponentID(target, targetCtx){\n    if(target.getAttribute(this.binding(\"target\"))){\n      return this.closestComponentID(targetCtx)\n    } else {\n      return null\n    }\n  }\n\n  closestComponentID(targetCtx){\n    if(targetCtx){\n      return maybe(targetCtx.closest(`[${PHX_COMPONENT}]`), el => this.ownsElement(el) && this.componentID(el))\n    } else {\n      return null\n    }\n  }\n\n  pushHookEvent(targetCtx, event, payload, onReply){\n    if(!this.isConnected()){\n      this.log(\"hook\", () => [`unable to push hook event. LiveView not connected`, event, payload])\n      return false\n    }\n    let [ref, els] = this.putRef([], \"hook\")\n    this.pushWithReply(() => [ref, els], \"event\", {\n      type: \"hook\",\n      event: event,\n      value: payload,\n      cid: this.closestComponentID(targetCtx)\n    }, (resp, reply) => onReply(reply, ref))\n\n    return ref\n  }\n\n  extractMeta(el, meta){\n    let prefix = this.binding(\"value-\")\n    for (let i = 0; i < el.attributes.length; i++){\n      let name = el.attributes[i].name\n      if(name.startsWith(prefix)){ meta[name.replace(prefix, \"\")] = el.getAttribute(name) }\n    }\n    if(el.value !== undefined){\n      meta.value = el.value\n\n      if (el.tagName === \"INPUT\" && CHECKABLE_INPUTS.indexOf(el.type) >= 0 && !el.checked) {\n        delete meta.value\n      }\n    }\n    return meta\n  }\n\n  pushEvent(type, el, targetCtx, phxEvent, meta){\n    this.pushWithReply(() => this.putRef([el], type), \"event\", {\n      type: type,\n      event: phxEvent,\n      value: this.extractMeta(el, meta),\n      cid: this.targetComponentID(el, targetCtx)\n    })\n  }\n\n  pushKey(keyElement, targetCtx, kind, phxEvent, meta){\n    this.pushWithReply(() => this.putRef([keyElement], kind), \"event\", {\n      type: kind,\n      event: phxEvent,\n      value: this.extractMeta(keyElement, meta),\n      cid: this.targetComponentID(keyElement, targetCtx)\n    })\n  }\n\n  pushFileProgress(fileEl, entryRef, progress, onReply = function(){}){\n    this.liveSocket.withinOwners(fileEl.form, (view, targetCtx) => {\n      view.pushWithReply(null, \"progress\", {\n        event: fileEl.getAttribute(view.binding(PHX_PROGRESS)),\n        ref: fileEl.getAttribute(PHX_UPLOAD_REF),\n        entry_ref: entryRef,\n        progress: progress,\n        cid: view.targetComponentID(fileEl.form, targetCtx)\n      }, onReply)\n    })\n  }\n\n  pushInput(inputEl, targetCtx, phxEvent, eventTarget, callback){\n    let uploads\n    let cid = this.targetComponentID(inputEl.form, targetCtx)\n    let refGenerator = () => this.putRef([inputEl, inputEl.form], \"change\")\n    let formData = serializeForm(inputEl.form, {_target: eventTarget.name})\n    if(inputEl.files && inputEl.files.length > 0){\n      LiveUploader.trackFiles(inputEl, Array.from(inputEl.files))\n    }\n    uploads = LiveUploader.serializeUploads(inputEl)\n    let event = {\n      type: \"form\",\n      event: phxEvent,\n      value: formData,\n      uploads: uploads,\n      cid: cid\n    }\n    this.pushWithReply(refGenerator, \"event\", event, resp => {\n      DOM.showError(inputEl, this.liveSocket.binding(PHX_FEEDBACK_FOR))\n      if(DOM.isUploadInput(inputEl) && inputEl.getAttribute(\"data-phx-auto-upload\") !== null){\n        if(LiveUploader.filesAwaitingPreflight(inputEl).length > 0) {\n          let [ref, els] = refGenerator()\n          this.uploadFiles(inputEl.form, targetCtx, ref, cid, (uploads) => {\n            callback && callback(resp)\n            this.triggerAwaitingSubmit(inputEl.form)\n          })\n        }\n      } else {\n        callback && callback(resp)\n      }\n    })\n  }\n\n  triggerAwaitingSubmit(formEl){\n    let awaitingSubmit = this.getScheduledSubmit(formEl)\n    if(awaitingSubmit){\n      let [el, ref, callback] = awaitingSubmit\n      this.cancelSubmit(formEl)\n      callback()\n    }\n  }\n\n  getScheduledSubmit(formEl){\n    return this.formSubmits.find(([el, callback]) => el.isSameNode(formEl))\n  }\n\n  scheduleSubmit(formEl, ref, callback){\n    if(this.getScheduledSubmit(formEl)){ return true }\n    this.formSubmits.push([formEl, ref, callback])\n  }\n\n  cancelSubmit(formEl){\n    this.formSubmits = this.formSubmits.filter(([el, ref, callback]) => {\n      if(el.isSameNode(formEl)){\n        this.undoRefs(ref)\n        return false\n      } else {\n        return true\n      }\n    })\n  }\n\n  pushFormSubmit(formEl, targetCtx, phxEvent, onReply){\n    let filterIgnored = el => {\n      let userIgnored = closestPhxBinding(el, `${this.binding(PHX_UPDATE)}=ignore`, el.form)\n      return !(userIgnored || closestPhxBinding(el, `data-phx-update=ignore`, el.form))\n    }\n    let filterDisables = el => {\n      return el.hasAttribute(this.binding(PHX_DISABLE_WITH))\n    }\n    let filterButton = el => el.tagName == \"BUTTON\"\n\n    let filterInput = el => [\"INPUT\", \"TEXTAREA\", \"SELECT\"].includes(el.tagName)\n\n    let refGenerator = () => {\n      let formElements = Array.from(formEl.elements)\n      let disables = formElements.filter(filterDisables)\n      let buttons = formElements.filter(filterButton).filter(filterIgnored)\n      let inputs = formElements.filter(filterInput).filter(filterIgnored)\n\n      buttons.forEach(button => {\n        button.setAttribute(PHX_DISABLED, button.disabled)\n        button.disabled = true\n      })\n      inputs.forEach(input => {\n        input.setAttribute(PHX_READONLY, input.readOnly)\n        input.readOnly = true\n        if(input.files){\n          input.setAttribute(PHX_DISABLED, input.disabled)\n          input.disabled = true\n        }\n      })\n      formEl.setAttribute(this.binding(PHX_PAGE_LOADING), \"\")\n      return this.putRef([formEl].concat(disables).concat(buttons).concat(inputs), \"submit\")\n    }\n\n    let cid = this.targetComponentID(formEl, targetCtx)\n    if(LiveUploader.hasUploadsInProgress(formEl)){\n      let [ref, els] = refGenerator()\n      return this.scheduleSubmit(formEl, ref, () => this.pushFormSubmit(formEl, targetCtx, phxEvent, onReply))\n    } else if(LiveUploader.inputsAwaitingPreflight(formEl).length > 0) {\n      let [ref, els] = refGenerator()\n      let proxyRefGen = () => [ref, els]\n      this.uploadFiles(formEl, targetCtx, ref, cid, (uploads) => {\n        let formData = serializeForm(formEl, {})\n        this.pushWithReply(proxyRefGen, \"event\", {\n          type: \"form\",\n          event: phxEvent,\n          value: formData,\n          cid: cid\n        }, onReply)\n      })\n    } else {\n      let formData = serializeForm(formEl)\n      this.pushWithReply(refGenerator, \"event\", {\n        type: \"form\",\n        event: phxEvent,\n        value: formData,\n        cid: cid\n      }, onReply)\n    }\n  }\n\n  uploadFiles(formEl, targetCtx, ref, cid, onComplete){\n    let joinCountAtUpload = this.joinCount\n    let inputEls = LiveUploader.activeFileInputs(formEl)\n\n    // get each file input\n    inputEls.forEach(inputEl => {\n      let uploader = new LiveUploader(inputEl, this, onComplete)\n      this.uploaders[inputEl] = uploader\n      let entries = uploader.entries().map(entry => entry.toPreflightPayload())\n\n      let payload = {\n        ref: inputEl.getAttribute(PHX_UPLOAD_REF),\n        entries: entries,\n        cid: this.targetComponentID(inputEl.form, targetCtx)\n      }\n\n      this.log(\"upload\", () => [`sending preflight request`, payload])\n\n      this.pushWithReply(null, \"allow_upload\", payload, resp => {\n        this.log(\"upload\", () => [`got preflight response`, resp])\n        if(resp.error){\n          this.undoRefs(ref)\n          let [entry_ref, reason] = resp.error\n          this.log(\"upload\", () => [`error for entry ${entry_ref}`, reason])\n        } else {\n          let onError = (callback) => {\n            this.channel.onError(() => {\n              if(this.joinCount === joinCountAtUpload){ callback() }\n            })\n          }\n          uploader.initAdapterUpload(resp, onError, this.liveSocket)\n        }\n      })\n    })\n  }\n\n  pushFormRecovery(form, callback){\n    this.liveSocket.withinOwners(form, (view, targetCtx) => {\n      let input = form.elements[0]\n      let phxEvent = form.getAttribute(this.binding(PHX_AUTO_RECOVER)) || form.getAttribute(this.binding(\"change\"))\n      view.pushInput(input, targetCtx, phxEvent, input, callback)\n    })\n  }\n\n  pushLinkPatch(href, targetEl, callback){\n    let linkRef = this.liveSocket.setPendingLink(href)\n    let refGen = targetEl ? () => this.putRef([targetEl], \"click\") : null\n\n    this.pushWithReply(refGen, \"link\", {url: href}, resp => {\n      if(resp.link_redirect){\n        this.liveSocket.replaceMain(href, null, callback, linkRef)\n      } else {\n        if(this.liveSocket.commitPendingLink(linkRef)){\n          this.href = href\n        }\n        this.applyPendingUpdates()\n        callback && callback(linkRef)\n      }\n    }).receive(\"timeout\", () => this.liveSocket.redirect(window.location.href))\n  }\n\n  formsForRecovery(html){\n    if(this.joinCount === 0){ return [] }\n\n    let phxChange = this.binding(\"change\")\n    let template = document.createElement(\"template\")\n    template.innerHTML = html\n\n    return(\n      DOM.all(this.el, `form[${phxChange}]`)\n         .filter(form => this.ownsElement(form))\n         .filter(form => form.elements.length > 0)\n         .filter(form => form.getAttribute(this.binding(PHX_AUTO_RECOVER)) !== \"ignore\")\n         .filter(form => template.content.querySelector(`form[${phxChange}=\"${form.getAttribute(phxChange)}\"]`))\n    )\n  }\n\n  maybePushComponentsDestroyed(destroyedCIDs){\n    let willDestroyCIDs = destroyedCIDs.filter(cid => {\n      return DOM.findComponentNodeList(this.el, cid).length === 0\n    })\n    if(willDestroyCIDs.length > 0){\n      this.pruningCIDs.push(...willDestroyCIDs)\n\n      this.pushWithReply(null, \"cids_will_destroy\", {cids: willDestroyCIDs}, () => {\n        // The cids are either back on the page or they will be fully removed,\n        // so we can remove them from the pruningCIDs.\n        this.pruningCIDs = this.pruningCIDs.filter(cid => willDestroyCIDs.indexOf(cid) !== -1)\n\n        // See if any of the cids we wanted to destroy were added back,\n        // if they were added back, we don't actually destroy them.\n        let completelyDestroyCIDs = willDestroyCIDs.filter(cid => {\n          return DOM.findComponentNodeList(this.el, cid).length === 0\n        })\n\n        if(completelyDestroyCIDs.length > 0){\n          this.pushWithReply(null, \"cids_destroyed\", {cids: completelyDestroyCIDs}, (resp) => {\n            this.rendered.pruneCIDs(resp.cids)\n          })\n        }\n      })\n    }\n  }\n\n  ownsElement(el){\n    return el.getAttribute(PHX_PARENT_ID) === this.id ||\n           maybe(el.closest(PHX_VIEW_SELECTOR), node => node.id) === this.id\n  }\n\n  submitForm(form, targetCtx, phxEvent){\n    DOM.putPrivate(form, PHX_HAS_SUBMITTED, true)\n    this.liveSocket.blurActiveElement(this)\n    this.pushFormSubmit(form, targetCtx, phxEvent, () => {\n      this.liveSocket.restorePreviouslyActiveFocus()\n    })\n  }\n\n  binding(kind){ return this.liveSocket.binding(kind)}\n}\n\nlet viewHookID = 1\nclass ViewHook {\n  static makeID(){ return viewHookID++ }\n  static elementID(el){ return el.phxHookId }\n\n  constructor(view, el, callbacks){\n    this.__view = view\n    this.__liveSocket = view.liveSocket\n    this.__callbacks = callbacks\n    this.__listeners = new Set()\n    this.__isDisconnected = false\n    this.el = el\n    this.viewName = view.name()\n    this.el.phxHookId = this.constructor.makeID()\n    for(let key in this.__callbacks){ this[key] = this.__callbacks[key] }\n  }\n\n  __mounted(){ this.mounted && this.mounted() }\n  __updated(){ this.updated && this.updated() }\n  __beforeUpdate(){ this.beforeUpdate && this.beforeUpdate() }\n  __destroyed(){ this.destroyed && this.destroyed() }\n  __reconnected(){\n    if(this.__isDisconnected){\n      this.__isDisconnected = false\n      this.reconnected && this.reconnected()\n    }\n  }\n  __disconnected(){\n    this.__isDisconnected = true\n    this.disconnected && this.disconnected()\n  }\n\n  pushEvent(event, payload = {}, onReply = function(){}){\n    return this.__view.pushHookEvent(null, event, payload, onReply)\n  }\n\n  pushEventTo(phxTarget, event, payload = {}, onReply = function(){}){\n    return this.__view.withinTargets(phxTarget, (view, targetCtx) => {\n      return view.pushHookEvent(targetCtx, event, payload, onReply)\n    })\n  }\n\n  handleEvent(event, callback){\n    let callbackRef = (customEvent, bypass) => bypass ? event : callback(customEvent.detail)\n    window.addEventListener(`phx:hook:${event}`, callbackRef)\n    this.__listeners.add(callbackRef)\n    return callbackRef\n  }\n\n  removeHandleEvent(callbackRef){\n    let event = callbackRef(null, true)\n    window.removeEventListener(`phx:hook:${event}`, callbackRef)\n    this.__listeners.delete(callbackRef)\n  }\n\n  __cleanup__(){\n    this.__listeners.forEach(callbackRef => this.removeHandleEvent(callbackRef))\n  }\n}\n\nexport default LiveSocket\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","if(!global[\"Phoenix\"]) global[\"Phoenix\"] = {};\nmodule.exports = global[\"Phoenix\"][\"LiveView\"] = require(\"-!/Users/samarsajnani/Documents/development/internal_tools/phoenix_live_view/assets/node_modules/babel-loader/lib/index.js!./phoenix_live_view.js\");"],"sourceRoot":""}